!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=16)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1);!function(e){e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error",e.TABLE="table",e.CUSTOM="custom"}(t.LogTypes||(t.LogTypes={}));var r=function(){function e(e){this.loggerSubject=e,this.isActive=!!window._middyo.debug}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logMessage("debug",e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logMessage("info",e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logMessage("error",e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logMessage("warn",e)},e.prototype.table=function(e){if(this.isActive)try{console.table(e)}catch(t){this.info("Table fallback: ",e)}},e.prototype.custom=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var r=[{msg:e,style:t,args:i}];this.logMessage("custom",r)},e.prototype.logMessage=function(e,t){this.isActive&&("custom"!==e?console[e].apply(console,["["+this.loggerSubject+"]"].concat(t)):console.info("%c["+this.loggerSubject+"] "+t[0].msg,t[0].style,t[0].args))},e.prototype.logWaterfallDetails=function(e,t,i){e.waterfall=e.waterfall||[];var r="x:"+e.ref.getBoundingClientRect().left+", y:"+e.offsetTop,o=e.selectedSize?n.Utils.sizeToString(e.selectedSize):"null";t.c.c?e.waterfall.push({provider:"header_bidding",adIndex:e.adIndex,adUnit:"-",size:o,position:r,isLazy:e.isLazyLoading,status:i}):(t=t,e.waterfall.push({provider:t.c.p,adIndex:e.adIndex,adUnit:t.c.au,size:o,position:r,isLazy:e.isLazyLoading,status:i})),this.info("Waterfall Table:"),this.table(e.waterfall)},e.prototype.hbLog=function(e,t,i,n){if(this.isActive){console.group("auction result "+t+", winner: %c"+n,"color:green;font-size:20px");var r=(e&&e.bids||[]).map(function(e){return{bidder:e.bidder,cpm:e.cpm,size:e.width+"x"+e.height,currency:e.currency}}),o=i.map(function(e){return{bidder:e.bidder,cpm:-1,size:"NA",currency:"NA"}});this.table(r.concat(o)),console.groupEnd()}},e}();t.Logger=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3),r=i(17),o=i(2),s=i(5),a=function(){function e(){}return e.buildBrowsiOutput=function(t){t.debugMode&&(window.browsiOutput=Object.assign(window.browsiOutput||{},t||{},{getFiredEvents:n.EventsService.getFiredEvents,f:e,getStayAwayElements:s.default.instance.getStayAwayElementsList}))},e.querySelector=function(e,t){if(e)try{return document.querySelector(e)}catch(i){t("Invalid selector ["+e+"]")}return null},e.getLoaderParams=function(){return window._middyo},e.isEmptyObj=function(e){return 0===Object.keys(e).length},e.querySelectorAll=function(e,t){return e&&e.length?e.reduce(function(e,i){var n=[];try{n=Array.from(document.querySelectorAll(i))}catch(e){t("Invalid selector ["+i+"]")}return e.concat(n)},new Array):[]},e.isElement=function(e){return e&&e instanceof Element},e.getPositionFallback=function(t){if(!t)return 0;var i=e.getElementPosition(t).y;if("none"!==t.style.display&&i>0)return i;for(var n,r=t.previousElementSibling;r;){if(n=e.getElementPosition(r).y,"none"!==r.style.display&&n>0)return r.getBoundingClientRect().height+n;r=r.previousElementSibling}return this.getPositionFallback(t.parentElement)},e.getElementPosition=function(e){var t={y:-1,x:-1};return e&&this.isElement(e)?t=this.getPosition(e):t},e.getPosition=function(e,t){void 0===t&&(t=!1);var i=e.getBoundingClientRect(),n=document.body,r=document.documentElement,o=t?window.pageYOffset||r.scrollTop||n.scrollTop:this.getPageYOffset(),s=window.pageXOffset||r.scrollLeft||n.scrollLeft,a=r.clientTop||n.clientTop||0,d=r.clientLeft||n.clientLeft||0,l=i.top+o-a,c=i.left+s-d;return{y:Math.round(l),x:Math.round(c)}},e.isDescendantElement=function(e,t){for(var i=0,n=e;i<n.length;i++){var r=n[i];if(this.isContainedElement(r,t))return!0}return!1},e.isContainedElement=function(e,t){return!(!e||!t)&&!!(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)},e.getElementSize=function(e){var t=e.getBoundingClientRect();return{h:t.height,w:t.width}},e.getViewportHeight=function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},e.getViewportWidth=function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},e.getElementFoldNumber=function(t){var i=document.body.getBoundingClientRect(),n=(t.getBoundingClientRect().top-i.top+r.FixedHeaderService.get().getNoneFixedHeaderSize())/e.getViewportHeight()+1;return Number(n.toFixed(2))},e.getScreenSize=function(){var e=window.top;return{w:e.screen.availWidth||e.screen.width,h:e.screen.availHeight||e.screen.height}},e.getPageWidth=function(){var e=window.top.document,t=e.body,i=e.documentElement;return Math.floor(Math.max(t.scrollWidth,t.offsetWidth,i.clientWidth,i.scrollWidth,i.offsetWidth))},e.getPageHeight=function(){var e=window.top.document,t=e.body,i=e.documentElement;return Math.floor(Math.max(t.scrollHeight,t.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight))},e.getElementCoordinates=function(e){var t=e.getBoundingClientRect(),i=document.body,n=document.documentElement,o=window.top.pageYOffset||n.scrollTop||i.scrollTop,s=window.top.pageXOffset||n.scrollLeft||i.scrollLeft,a=n.clientTop||i.clientTop||0,d=n.clientLeft||i.clientLeft||0,l=t.top+o-a+r.FixedHeaderService.get().getNoneFixedHeaderSize(),c=t.left+s-d;return{top:Math.round(l),left:Math.round(c)}},e.isVisible=function(t){var i=t;return e.isElement(i)&&null!==i.offsetParent&&i.getBoundingClientRect().height>1&&"0"!==window.getComputedStyle(i).opacity},e.calculateDistanceBetween=function(t,i){var n=0;if(t&&i&&t!==i){var r=e.sortElementsByDomOrder(t,i);n=e.getElementCoordinates(r.lower).top-e.getElementCoordinates(r.upper).top,e.isDescendantElement([r.upper],r.lower)||(n-=e.getElementSize(r.upper).h)}return n},e.calculateTextNodeHeight=function(t){var i=e.nextVisibleSibling(t),n=e.nextVisibleSibling(t,!0);if(i){if(t.nodeValue&&n)return e.calculateDistanceBetween(n,i)}else if(t.parentElement&&n){var r=t.parentElement.getBoundingClientRect(),o=n.getBoundingClientRect();return r.top+r.height-(o.top+o.height)}return 0},e.nextVisibleSibling=function(t,i){for(var n=i?t.previousElementSibling:t.nextElementSibling;n&&!e.isVisible(n);)n=i?n.previousElementSibling:n.nextElementSibling;return n},e.sortElementsByDomOrder=function(t,i){return e.getElementCoordinates(t).top<e.getElementCoordinates(i).top?{upper:t,lower:i}:{upper:i,lower:t}},e.getHighestElement=function(e,t){return this.sortElementsByDomOrder(e,t).upper},e.getMaxWrapSize=function(e){var t=e.filter(function(e){return e.optionalEmbeddings.includes("wrapped")});return t.length?t.reduce(function(e,t){return e.h>t.h?e:t}):{w:0,h:0}},e.isFloatImage=function(e){if("IMG"!==e.nodeName)return!1;var t=window.getComputedStyle(e);return"right"===t.getPropertyValue("float")||"left"===t.getPropertyValue("float")},e.isParagraphElement=function(e){return"P"===e.nodeName},e.isEmptyParagraph=function(e){return!(!this.isParagraphElement(e)||this.isNullOrUndefined(e.textContent))&&0===e.textContent.replace(/\s*/,"").length},e.isPositionContained=function(e,t){return!!(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)},e.isPositionOrderAs=function(e,t){return!!t&&!!(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING)},e.isPositionFixed=function(e){return"fixed"===window.getComputedStyle(e).position||!!e.parentElement&&this.isPositionFixed(e.parentElement)},e.removeElementsPositionedAfter=function(t,i){return this.isNullOrUndefined(t)?i:i.filter(function(i){return e.isPositionOrderAs(i,t)})},e.toUrlParams=function(e){return Object.keys(e).map(function(t){return t+"="+("object"==typeof e[t]?encodeURIComponent(JSON.stringify(e[t])):encodeURIComponent(e[t]))}).join("&")},e.onIframeLoad=function(e,t){if(e.contentWindow&&"complete"===e.contentWindow.document.readyState)t();else var i=window.setInterval(function(){e.contentWindow&&"complete"===e.contentWindow.document.readyState&&(window.clearInterval(i),t())},100)},e.getMarginTopBySpotStyle=function(e,t,i){i=i.previousElementSibling&&"break"===t?i.previousElementSibling:e.ref;var n=window.getComputedStyle(i),r=16,o=n.margin.split(" ");if(n.margin){var s=Number(o[0].replace("px",""));r="break"===t?r-s:s}else if(n.marginTop){s=Number(n.marginTop.replace("px",""));r="break"===t?r-s:s}return(isNaN(r)||r<0)&&(r=16),r},e.getDfpEventSize=function(e){return e.size?{w:e.size[0],h:e.size[1]}:{w:-1,h:-1}},e.appendScript=function(e,t){return new Promise(function(i,n){var r=document.createElement("script");r.async=!0,r.setAttribute("src",e),r.addEventListener("load",function(){i("success")}),r.addEventListener("error",function(){n("error")}),t.iframe?t.iframe.contentDocument.body.appendChild(r):t.wrapper&&t.wrapper.appendChild(r)})},e.createClass=function(e,t,i){var n=i.createElement("style");n.type="text/css",i.getElementsByTagName("head")[0].appendChild(n),(n.sheet||{}).insertRule?n.sheet.insertRule(e+"{"+t+"}",0):(n.styleSheet||n.sheet).addRule(e,t)},e.buildAdMarking=function(t,i){var n=document.createElement("div");n.innerText=i.text,n.id="browsi_adv_"+t.adIndex;var r=i.color?"height: 16px !important;\npadding: 0 !important;\nfont-family: Arial, sans-serif !important;\nmargin: auto !important;\nmargin-bottom: 10px !important;\ntext-align: center !important;\nline-height: 16px !important;\nfont-weight: normal !important;\ncolor:  "+i.color+" !important;\nfont-size: 11px !important;":i.customStyle?i.customStyle:"";return e.createClass(".browsi_adv_"+t.adIndex,r,document),n.setAttribute("class","browsi_adv_"+t.adIndex),n},e.getAdMarkingExpectedHeight=function(){var e=o.Profiler.get().adMarking;if(e){var t=document.createElement("div");t.innerText=e.text;var i=e.color?"height: 16px !important;\npadding: 0 !important;\nfont-family: Arial, sans-serif !important;\nmargin: auto !important;\nmargin-bottom: 10px !important;\ntext-align: center !important;\nline-height: 16px !important;\nfont-weight: normal !important;\ncolor:  "+e.color+" !important;\nfont-size: 11px !important;":e.customStyle?e.customStyle:"";t.setAttribute("style",i),t.style.visibility="hidden",document.body.appendChild(t);var n=t.style.marginTop&&parseInt(t.style.marginTop)||0,r=t.style.marginBottom&&parseInt(t.style.marginBottom)||0,s=t.clientHeight+n+r;return document.body.removeChild(t),s}return 0},e.getScrollPosition=function(){var e=r.FixedHeaderService.get();return{top:window.top.pageYOffset+e.getNoneFixedHeaderSize()+e.getFixedHeaderSize(),bottom:window.top.pageYOffset+window.top.innerHeight}},e.getLogStyle=function(e,t,i){return"font-size:"+e+"px;color:"+t+";background:"+i+";"},e.sortSpotsByOffsetTop=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.sort(function(e,t){return e.offsetTop-t.offsetTop})},e.sortSpotsByPosition=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.sort(function(t,i){return e.getPositionFallback(t.ref)-e.getPositionFallback(i.ref)})},e.sortElementsByPosition=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.sort(function(t,i){return e.getPositionFallback(t)-e.getPositionFallback(i)})},e.getCurrentTime=function(e){var t=Date.now();return e?Math.floor(t/1e3):t},e.isFluidSize=function(e){return 0===e.w&&0===e.h},e.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object.assign.apply(Object,[{}].concat(e))},e.getSpotCoords=function(t){return t.isImpression&&t.browsiAd.container?t.browsiAd.iframe?e.getElementCoordinates(t.browsiAd.iframe):e.getElementCoordinates(t.browsiAd.container):e.getElementCoordinates(t.ref)},e.findParentElementByType=function(e,t){for(var i=null,n=0,r=Array.from(document.querySelectorAll(e));n<r.length;n++){var o=r[n];this.isContainedElement(o,t)&&(i=o)}return i},e.isObject=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e},e.mergeDeep=function(e,t){var i=this;return this.isObject(e)&&this.isObject(t)&&Object.keys(t).forEach(function(n){var r,o;i.isObject(t[n])?(e[n]||Object.assign(e,((r={})[n]={},r)),i.mergeDeep(e[n],t[n])):Object.assign(e,((o={})[n]=t[n],o))}),e},e.removeSpaces=function(e){return e.replace(/(\n|\r|\s+)/gm,"")},e.getElementOffsetDistanceFromSpot=function(e,t,i){var n=e.parentElement?e.parentElement.getBoundingClientRect().width:e.getBoundingClientRect().width;return i-t.h+t.w*t.h/n},e.getMaxWrappingOffsetDistance=function(t,i){var n=t.parentElement?t.parentElement:t,r=getComputedStyle(n),o=n.getBoundingClientRect().width;o-=parseFloat(r.paddingLeft||"0")+parseFloat(r.paddingRight||"0");var s=e.getWrapFullSize(i),a=s.h+this.getAdMarkingExpectedHeight();return s.w*a/o-a},e.isPositionedAfter=function(e,t){return!!t&&!!(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING)},e.getEmbedTypesFromSizes=function(e){for(var t=[],i=!1,n=!1,r=0,o=e;r<o.length;r++)for(var s=0,a=o[r].optionalEmbeddings;s<a.length;s++){var d=a[s];if("break"!==d||n?"wrapped"!==d&&"left"!==d&&"right"!==d||i||(t.push("wrapped"),i=!0):(t.push(d),n=!0),n&&i)return t}return t},e.sizeToString=function(e){return e.w+"x"+e.h},e.isEngagedUser=function(){var t=o.Profiler.get();return!t.engagedUsers.active||(e.getScrollPosition().top>0||t.engagedUsers.engaged)},e.removeElement=function(e){return!(!e||!e.parentElement)&&(e.parentElement.removeChild(e),!0)},e.throttle=function(e,t){var i=!1;return function(n){i||(e(n),i=!0,setTimeout(function(){i=!1,e(n)},t))}},e.getCurrentFoldDecimal=function(){var e=this.getScreenSize();return this.getScrollPosition().top/e.h+1},e.getScrollDepthPercentages=function(){var e=this.getScrollingDistance();return this.getDepthPercentages(e)},e.getScrollingDistance=function(){return this.getPageYOffset()+this.getWindowHeight()},e.getDepthPercentages=function(e){var t=this.getPageHeight()||1;return e=e||0,Math.round(e/t*100)},e.getWindowHeight=function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},e.getPageYOffset=function(){return window.pageYOffset||("CSS1Compat"===document.compatMode?document.documentElement.scrollTop:document.body.scrollTop)},e.getNowInSeconds=function(){return Math.floor(Date.now()/1e3)},e.getTimeOffset=function(){return Date.now()-this.getLoaderParams().to},e.getCookie=function(e){var t=encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&"),i=new RegExp("(?:(?:^|.*;)\\s*"+t+"\\s*\\=\\s*([^;]*).*$)|^.*$"),n=document.cookie.replace(i,"$1");return decodeURIComponent(n)||""},e.compareObjectKeys=function(e,t){return JSON.stringify(Object.keys(e))===JSON.stringify(Object.keys(t))},e.getExternalFlowHandler=function(e){var t=o.Profiler.get().rules;if(t&&t[e]&&"function"==typeof t[e])return t[e]},e.toSet=function(e){var t=new Set;return e.forEach(function(e){return t.add(e)}),t},e.toUnique=function(e){var t=[];return this.toSet(e).forEach(function(e){return t.push(e)}),t},e.getMainContentSize=function(t){if(!t||!t.mainContent.lastElement||!t.mainContent.firstElement)return-1;var i=e.getElementCoordinates(t.mainContent.firstElement).top,n=t.mainContent.borderElement?e.getElementCoordinates(t.mainContent.borderElement).top:e.getElementCoordinates(t.mainContent.lastElement).top+t.mainContent.lastElement.getBoundingClientRect().height;return Math.round(n-i)},e.reportNewBrowsiAd=function(e){var t=new CustomEvent("ban",{detail:e});window.top.dispatchEvent(t)},e.reportBrowsiAdRemoved=function(e){var t=new CustomEvent("bar",{detail:e});window.top.dispatchEvent(t)},e.clone=function(e){return JSON.parse(JSON.stringify(e))},e.shouldLookForFixed=function(){var e=this.getLoaderParams();return e.e.fs&&e.e.fs.mi>0},e.getWrapFullSize=function(e){var t=o.Profiler.get().spotsConfig.s,i=t.l.p.r+t.l.p.l>t.r.p.r+t.r.p.l?t.l.p:t.r.p,n=t.l.m.r+t.l.m.l>t.r.m.r+t.r.m.l?t.l.m:t.r.m;return{w:e.w+i.l+n.l+i.r+n.r,h:e.h+i.b+n.b+i.t+n.t}},e.xhrPromise=function(e,t){return new Promise(function(i,n){var r=new XMLHttpRequest;r.open(t||"GET",e,!0),r.onreadystatechange=function(){r.readyState==XMLHttpRequest.DONE&&(200==r.status?i(r.responseText):n(null))},r.send()})},e.findAllChildrenScripts=function(e){return Array.from(e.querySelectorAll("SCRIPT"))},e.isNullOrUndefined=function(e){return null===e||void 0===e},e}();t.Utils=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),r=i(0),o=i(5),s=function(){function e(e){this._profile=this.buildProfile(e,this.getRules(e))}return e.prototype.getRules=function(t){if(t.externalFlowHandler&&t.externalFlowHandler.preEngine){try{e.logger.info("initiating rules"),t.externalFlowHandler.preEngine(t)}catch(t){e.logger.error("failed to initiating rules",t)}return t.externalFlowHandler}},e.get=function(){return e.instance||(e.instance=new e(n.Utils.getLoaderParams())),e.instance._profile},e.prototype.buildProfile=function(e,t){var i=e.e.sc;i.s=n.Utils.mergeDeep(this.getDefaultStyling(),i.s);var r=n.Utils.getScreenSize();return{debugMode:!!e.debug&&e.debug,identity:{siteKey:e.i.sk,publisherKey:e.i.pk,userId:e.i.u,sessionId:e.i.s,pageviewId:e.i.pv,isBenchmarkPageview:e.r.b,bootstrapPageviewId:e.bpvi,supplyConfigId:e.i.sc,url:encodeURIComponent(location.protocol+"//"+location.host+location.pathname),timeOffset:e.to,articleId:e.i.aid},yieldData:{isBenchmarked:e.r.b,countryCode:e.r.cc,trafficSource:e.r.ts,isReturningUser:e.r.ru,version:e.e.v,eventServerUrl:e.r.es,host:e.yhn},deviceDetails:{browser:e.dt.b,device:e.dt.d,deviceType:e.dt.p,os:e.dt.os,osVersion:e.dt.osv,screenWidth:r.w,screenHeight:r.h,browserType:e.dt.bt,deviceVendor:e.dt.v},potentialSpots:e.e.ps,userShort:e.e.us,referrer:encodeURIComponent(window.top.document.referrer),analysisMode:e.e.am,enableMoat:e.e.em,fixedHeader:e.e.fh,spotsConfig:i,fixedSpotsConfig:e.e.fs,adMarking:this.getAdMarkingConfiguration(e.e.sc.mrk),foldsConfiguration:this.getFoldConfiguration(e.e.fc),state:"bootstrap_loaded",allowNarrowBreak:i.anb||!1,targetSelectors:e.e.ts||[],wrappingAdditionalElements:e.e.wae||[],prebidPath:e.e.pp,prebidData:e.e.pd,adBlockerDetectionUrl:e.e.abd,rules:t,engagedUsers:{engaged:!1,active:e.e.eo},lazySpots:e.e.ls,logEngagement:e.e.le,blockAdRequestOnOOF:e.e.barof,disableSpotAfterTitle:e.e.dts,placementIdMacro:e.e.plidm,adInViewport:e.e.aiv}},e.buildMainContent=function(t,i,r,o){var s=o.e.mc.u,a={start:-1,width:-1,widthThreshold:r,elements:[],endPosition:-1,inputElements:[],firstElement:null,lastElement:null,borderElement:null};if(t.length){var d=null;o.e.mc.e&&(d=n.Utils.querySelector(o.e.mc.e,this.errorCallback));var l=this.getPotentialSpots(o.e.ts||[],t,d);e.logger.debug("all main content + targetSelector elements: ",l);var c=n.Utils.querySelector(s,this.errorCallback)||t[0],p=t[t.length-1];a={start:n.Utils.getElementCoordinates(c).top,width:i,widthThreshold:r,elements:l,endPosition:d?n.Utils.getElementCoordinates(d).top:n.Utils.getElementCoordinates(p).top+p.getBoundingClientRect().height,inputElements:t,firstElement:c,lastElement:p,borderElement:d}}return a},e.buildFixedAdSizes=function(e,t){var i=this,n=[];return e.forEach(function(e){if(0!==t.length){var r=i.getWidthForEmbed(e),o=i.buildAdSizes(r,t,!0,!1);t=t.filter(function(e){return!o.find(function(t){return t.h===e.h&&t.w===e.w})}),n=n.concat(o)}}),n},e.buildAdSizes=function(e,t,i,r){var o=this,s=[],a=n.Utils.getAdMarkingExpectedHeight();return t.forEach(function(t){if(e>=t.w||n.Utils.isFluidSize(t)){var d=o.getAdSizeType(t);s.push({w:t.w,h:t.h,adSizeType:d,minSizeForWrapping:o.calculateValidHeights(t,e,a),optionalEmbeddings:o.getEmbedTypes(d,t.h,i,r)})}}),s},e.getAdSizeType=function(e){return n.Utils.isFluidSize(e)?"wide":e.w<=this.maxNarrowAdWidth?"narrow":"wide"},e.getEmbedTypes=function(e,t,i,n){var r=[];return"narrow"==e?(t<=this.maxNarrowAdHeightForBreak&&i&&r.push("break"),n&&r.push("wrapped")):r.push("break"),r},e.calculateValidHeights=function(e,t,i){var r=n.Utils.getWrapFullSize(e);return r.h+=i,r.h-r.h*r.w/t},e.getSkippedElements=function(e,t,i){return n.Utils.querySelectorAll(e,i).filter(function(e){return t.includes(e)||n.Utils.isDescendantElement(t,e)})},e.validateProfileForBehavior=function(e,t,i){var n=[];return e.start>e.stop&&n.push("startIF/stopIF_Violation"),0===t.length&&n.push("No_compatibleSizes"),0===i.length&&n.push("No_Elements_For_Scan"),n},e.prototype.getFoldConfiguration=function(e){return e.stop>0?e:{start:e.start,stop:1e6}},e.prototype.getAdMarkingConfiguration=function(e){if(e){var t={text:e.t};return e.c?t.color=e.c:e.s&&(t.customStyle=e.s),t}return null},e.getPotentialSpots=function(e,t,i){var r=this.collectMcElements(e,t);return i&&n.Utils.isDescendantElement(t,i)&&(r=n.Utils.removeElementsPositionedAfter(i,r)),r},e.collectMcElements=function(e,t){var i=[];e.length&&(i=t.reduce(function(t,i){return t.concat(Array.from(i.querySelectorAll(""+e.toString())).filter(function(e){return n.Utils.isVisible(e)}))},[]));var r=t.reduce(function(e,t){return e.concat(Array.from(t.querySelectorAll("p")).filter(function(e){return n.Utils.isVisible(e)&&!n.Utils.isDescendantElement(i,e)}))},[]).concat(i).sort(function(e,t){return n.Utils.isPositionedAfter(e,t)?1:-1});return n.Utils.toUnique(r)},e.detectAdBlocker=function(t){e.adBlockerExists?t():new Promise(function(t,i){function n(){"undefined"===window.adblockDetector?t(!1):window.adblockDetector.init({debug:e.get().debugMode,found:function(){t(!0)},notFound:function(){t(!1)}})}var r=document.createElement("script");r.src=e.get().adBlockerDetectionUrl,r.setAttribute("crossorigin","anonymous"),r.onload=n,r.onerror=n,document.body.appendChild(r)}).then(function(i){e.adBlockerExists=i,e.logger.custom("Ad Blocker Detected: "+i,n.Utils.getLogStyle(18,"black","green")),t()})},e.collectDOMData=function(){var t=window._middyo,i=n.Utils.querySelectorAll([t.e.mc.s],e.errorCallback).filter(function(e){return n.Utils.isVisible(e)}),r=o.default.instance.getStayAwayElementsList(),s=this.getSkippedElements(t.e.se,i,e.errorCallback),a=this.getSkippedElements(["div[style*=float] + p, img[style*=float]+p, iframe[style*=float] + p"],i,e.errorCallback),d=this.getWidthForEmbed(i[0]),l=t.e.mc.t?t.e.mc.t:500,c=d>=l,p=t.e.sc.anb||!1,u=t.e.sc.cs||[],h=this.buildAdSizes(d,u,p,c),f=t.e.fs||{},g=f.as&&f.as.length>0?f.as:u,m=n.Utils.sortElementsByPosition.apply(n.Utils,n.Utils.querySelectorAll(f.te||[],e.errorCallback)),v=this.buildFixedAdSizes(m,g);return e.logger.debug("all fixed spots elements: ",m),{mainContent:this.buildMainContent(i,d,l,t),stayAwayElements:r,skippedElements:s,dynamicCompatibleSizes:h,foundFloatElements:a,allowNarrowWrap:c,fixedSpotsElements:m,fixedCompatibleSizes:v}},e.getWidthForEmbed=function(e){var t=e?e.getBoundingClientRect().width:-1;if(n.Utils.isElement(e)){var i=window.getComputedStyle(e);i.paddingLeft&&i.paddingRight&&(t-=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight))}return t},e.prototype.getDefaultStyling=function(){return{b:{m:{b:16,t:16}},l:{m:{t:-1,r:16,b:16,l:0},p:{t:-1,r:0,b:0,l:0}},r:{m:{t:-1,r:0,b:16,l:16},p:{t:-1,r:0,b:0,l:0}}}},e.logger=new r.Logger("Profiler"),e.errorCallback=function(t){return e.logger.error(t)},e.maxNarrowAdHeightForBreak=400,e.maxNarrowAdWidth=400,e}();t.Profiler=s},function(e,t,i){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),o=i(0),s=i(1),a=function(){function e(){this.commonFields=this.buildCommonFields(),this.eventServerUrl=r.Profiler.get().yieldData.eventServerUrl,this.logger=new o.Logger("Events"),this.profile=r.Profiler.get()}return e.get=function(){return e._instance||(this._instance=new e),e._instance},e.prototype.sendEngineLoadedEvent=function(){var e=r.Profiler.get(),t=this.getEngineLoadedEvent(e);this.send("supply",t.et,[t])},e.prototype.sendSpotFoundEvent=function(e){var t=this.getSpotFoundEvent(e);this.send("demand",t.et,[t])},e.prototype.sendPageviewEvent=function(e,t,i){var n=i&&i.length>0?{rsn:i.join(";")}:{},r=this.getPageviewEvent(e,t,n);this.send("supply",r.et,[r])},e.prototype.sendAdBlockerEvent=function(){var e=this.getAdBlockerEvent();this.send("supply",e.et,[e])},e.prototype.sendSpotEngineDoneEvent=function(){var e=r.Profiler.get(),t=this.getSpotEngineDoneEvent(e);this.send("supply",t.et,[t])},e.prototype.sendAdRequest=function(e,t){var i=this.getAdRequestEvent(e,t);this.send("demand",i.et,[i])},e.prototype.sendAdMatchedEvent=function(e,t,i,n){var r=this.getAdMatchedEvent(e,t,i,n);this.send("demand",r.et,[r])},e.prototype.sendAdImpression=function(e,t,i){var n=s.Utils.getSpotCoords(e),r=this.getAdImpressionEvent(n,e,t,i);this.send("demand",r.et,[r])},e.prototype.sendViewedImpression=function(e,t){var i=s.Utils.getSpotCoords(e),n=this.getViewedImpressionEvent(i,e,t);this.send("demand",n.et,[n])},e.prototype.sendViewedImpression100=function(e){var t=s.Utils.getSpotCoords(e),i=this.getViewedImpression100Event(t,e);this.send("demand",i.et,[i])},e.prototype.sendViewedPublisherAd=function(e,t){var i=this.getViewedPublisherAdEvent(e,t);this.send("demand",i.et,[i])},e.prototype.sendUserEngagementEvent=function(){var e=this.getUserEngagementEvent();this.send("supply",e.et,[e])},e.prototype.sendEngagementReportEvent=function(e){var t=this,i=e.map(function(e){return Object.assign({},t.commonFields,e)});this.send("engagement",i[0].et,i)},e.prototype.sendBidRequest=function(e,t){var i=this,n=s.Utils.getSpotCoords(t),r=e.map(function(e){return Object.assign({},i.getBidRequestEvent(n,t,e.bidderName,e.adUnit))});this.send("demand",r[0].et,r)},e.prototype.sendBidMatched=function(e,t,i){var n=this,r=e.map(function(e){return Object.assign({},n.getBidMatchedEvent(i,t,e))});this.send("demand",r[0].et,r)},e.prototype.sendAdBlockedEvent=function(e,t,i){e.adRequestBlockedSent=!0;var n=this.getAdBlockedEvent(e,t,i);this.send("demand",n.et,[n])},e.prototype.sendFocusChangedEvent=function(e){var t=this.getFocusChangedEvent(e);this.send("supply",t.et,[t])},e.prototype.sendPublisherAdFound=function(e){var t=this.getPublisherAdFoundEvent(e);this.send("demand",t.et,[t])},e.prototype.sendAdInViewport=function(e,t){var i=this.getAdInViewportEvent(e,t);this.send("supply",i.et,[i])},e.prototype.getEngineLoadedEvent=function(e){return Object.assign({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"engine_loaded",to:this.getTimeOffset(),res:e.deviceDetails.screenWidth+"x"+e.deviceDetails.screenHeight})},e.prototype.getSpotFoundEvent=function(e){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"spot_found",adix:e.adIndex,f:this.getFold(e),pt:e.positionTypes.join(","),ot:e.offsetTop,to:this.getTimeOffset(),dcs:!1,ill:e.isLazyLoading,pw:s.Utils.getPageWidth(),st:e.type})},e.prototype.getPageviewEvent=function(e,t,i){return n({},this.commonFields,i,{now:s.Utils.getCurrentTime(!0),et:"page_view",bpvid:this.profile.identity.bootstrapPageviewId,sf:e,fsf:t,dcs:!1,ie:e+t>0,tlls:-1,pl:s.Utils.getPageHeight(),pw:s.Utils.getPageWidth(),to:this.getTimeOffset(),res:this.profile.deviceDetails.screenWidth+"x"+this.profile.deviceDetails.screenHeight,scid:this.profile.identity.supplyConfigId,iru:this.profile.yieldData.isReturningUser,mcs:this.profile.domData?this.profile.domData.mainContent.start:-1,mcw:this.profile.domData?this.profile.domData.mainContent.width:-1,mch:s.Utils.getMainContentSize(this.profile.domData),sl:this.profile.deviceDetails.screenHeight})},e.getFiredEvents=function(){return e.firedEvents},e.prototype.getAdBlockerEvent=function(){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"ad_blocker",to:this.getTimeOffset(),ex:r.Profiler.adBlockerExists})},e.prototype.getUserEngagementEvent=function(){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"user_engaged",to:this.getTimeOffset()})},e.prototype.getSpotEngineDoneEvent=function(e){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"spot_engine_done",pl:s.Utils.getPageHeight(),to:this.getTimeOffset(),scid:e.identity.supplyConfigId,res:e.deviceDetails.screenWidth+"x"+e.deviceDetails.screenHeight})},e.prototype.getAdRequestEvent=function(e,t){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"ad_request",adf:"display",adix:e.adIndex,au:e.adUnit,saas:e.isSaas,atix:e.attemptIndex,pr:t,f:this.getFold(e),ot:s.Utils.getSpotCoords(e).top,ill:e.isLazyLoading,pw:s.Utils.getPageWidth(),rc:e.refresh.count,to:this.getTimeOffset(),ul:s.Utils.getScrollPosition().top,st:e.type,pt:e.positionTypes.join(","),di:e.demandIndex})},e.prototype.getAdBlockedEvent=function(e,t,i){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"ad_request_blocked",adf:"display",adix:e.adIndex,au:e.adUnit,saas:e.isSaas,atix:e.attemptIndex,f:this.getFold(e),ot:s.Utils.getSpotCoords(e).top,ill:e.isLazyLoading,pw:s.Utils.getPageWidth(),rc:e.refresh.count,to:this.getTimeOffset(),rsn:t,msg:i,ul:s.Utils.getScrollPosition().top,st:e.type,pt:e.positionTypes.join(",")})},e.prototype.getPublisherAdFoundEvent=function(e){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"found_publisher_ad",adix:-1,au:e.adUnit,f:e.foldNum,ot:s.Utils.getElementCoordinates(e.element).top,ol:s.Utils.getElementCoordinates(e.element).left,ill:e.isLazyLoaded,pw:s.Utils.getPageWidth(),to:this.getTimeOffset(),pr:e.providerName,pt:e.positionType.join(","),h:e.height,w:e.width,plid:e.placementId,ul:s.Utils.getScrollPosition().top,rc:e.refreshCount})},e.prototype.getViewedPublisherAdEvent=function(e,t){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"viewed_publisher_ad",adix:-1,au:e.adUnit,f:e.foldNum,ot:s.Utils.getElementCoordinates(e.element).top,ol:s.Utils.getElementCoordinates(e.element).left,ill:e.isLazyLoaded,pw:s.Utils.getPageWidth(),to:this.getTimeOffset(),pr:e.providerName,pt:e.positionType.join(","),h:e.height,w:e.width,plid:e.placementId,ul:s.Utils.getScrollPosition().top,c:1,tiv:-1,piv:t,rc:e.refreshCount})},e.prototype.getAdMatchedEvent=function(e,t,i,r){return n({},this.commonFields,r?{rsn:r}:{},{now:s.Utils.getCurrentTime(!0),et:"ad_matched",adf:"display",adix:e.adIndex,au:e.adUnit,im:i,saas:e.isSaas,atix:e.attemptIndex,w:e.selectedSize?e.selectedSize.w:-1,h:e.selectedSize?e.selectedSize.h:-1,pr:t,emt:e.selectedSize&&e.selectedSize.selectedEmbedding?e.selectedSize.selectedEmbedding:"NA",ft:-1,ot:s.Utils.getSpotCoords(e).top,f:this.getFold(e),ill:e.isLazyLoading,pw:s.Utils.getPageWidth(),rc:e.refresh.count,to:this.getTimeOffset(),st:e.type,pt:e.positionTypes.join(","),di:e.demandIndex})},e.prototype.getAdImpressionEvent=function(e,t,i,r){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"ad_impression",adf:"display",au:t.adUnit,h:t.browsiAd.h,w:t.browsiAd.w,adix:t.adIndex,saas:t.isSaas,emt:r,atix:t.attemptIndex,ol:e.left,ot:e.top,pr:i,f:this.getFold(t),ft:-1,ill:t.isLazyLoading,dcs:!1,pw:s.Utils.getPageWidth(),rc:t.refresh.count,to:this.getTimeOffset(),ul:s.Utils.getScrollPosition().top,st:t.type,pt:t.positionTypes.join(","),di:t.demandIndex})},e.prototype.getViewedImpressionEvent=function(e,t,i){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"viewed_impression",adf:"display",adix:t.adIndex,au:t.adUnit,saas:t.isSaas,h:t.browsiAd.h,w:t.browsiAd.w,emt:t.selectedSize&&t.selectedSize.selectedEmbedding?t.selectedSize.selectedEmbedding:"NA",ol:e.left,ot:e.top,atix:t.attemptIndex,c:1,pr:t.providerName,f:this.getFold(t),ft:-1,to:this.getTimeOffset(),pw:s.Utils.getPageWidth(),rc:t.refresh.count,tiv:-1,piv:i,dcs:!1,ill:t.isLazyLoading,st:t.type,pt:t.positionTypes.join(","),di:t.demandIndex})},e.prototype.getViewedImpression100Event=function(e,t){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"v_100",adf:"display",adix:t.adIndex,au:t.adUnit,saas:t.isSaas,h:t.browsiAd.h,w:t.browsiAd.w,emt:t.selectedSize&&t.selectedSize.selectedEmbedding?t.selectedSize.selectedEmbedding:"NA",ol:e.left,ot:e.top,atix:t.attemptIndex,c:1,pr:t.providerName,f:this.getFold(t),ft:-1,to:this.getTimeOffset(),pw:s.Utils.getPageWidth(),rc:t.refresh.count,tiv:-1,dcs:!1,ill:t.isLazyLoading,st:t.type,pt:t.positionTypes.join(","),di:t.demandIndex})},e.prototype.getBidRequestEvent=function(e,t,i,r){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"bid_request",bn:i,adf:"display",adix:t.adIndex,au:r,atix:t.attemptIndex,saas:t.isSaas,pr:t.providerName,f:this.getFold(t),ot:e.top,ol:e.left,ill:t.isLazyLoading,pw:s.Utils.getPageWidth(),rc:t.refresh.count,to:this.getTimeOffset(),st:t.type,di:t.demandIndex})},e.prototype.getBidMatchedEvent=function(e,t,i){return n({},this.commonFields,i.reason?{rsn:i.reason}:{},i.size,{now:s.Utils.getCurrentTime(!0),et:"bid_matched",bn:i.bidderName,br:i.bidRate,brc:i.currency,im:i.isMatched,adf:"display",adix:t.adIndex,au:i.adUnit,atix:t.attemptIndex,saas:t.isSaas,pr:t.providerName,f:this.getFold(t),ot:e.top,ol:e.left,ill:t.isLazyLoading,pw:s.Utils.getPageWidth(),rc:t.refresh.count,to:this.getTimeOffset(),st:t.type,di:t.demandIndex})},e.prototype.getFocusChangedEvent=function(e){return n({},this.commonFields,{now:s.Utils.getCurrentTime(!0),et:"focus_changed",if:e,to:this.getTimeOffset()})},e.prototype.getAdInViewportEvent=function(e,t){return{now:s.Utils.getCurrentTime(!0),et:"ad_in_viewport",to:this.getTimeOffset(),pvid:this.commonFields.pvid,rc:e.refresh.count,atix:e.attemptIndex,adix:e.adIndex,ivp:t.toFixed(2)}},e.prototype.sendHBWinner=function(e,t){var i={now:s.Utils.getNowInSeconds(),et:"hbw",sk:this.commonFields.sk,dp:this.commonFields.dp,to:s.Utils.getTimeOffset(),pvid:this.commonFields.pvid,adix:e.adIndex,di:e.demandIndex,atix:e.attemptIndex,rc:e.refresh.count,bn:t.bidder};this.send("demand","hbw",[i])},e.prototype.send=function(t,i,n){var r,o=new XMLHttpRequest;o.open("POST",""+this.eventServerUrl+t+"?p="+this.commonFields.pvid,!0),o.send(JSON.stringify(n)),e.addToFiredEvents(t,i,n),(r=this.logger).custom.apply(r,[t+"/"+i,"background: #AAFF7F; color: black; font-weight: bold; text-decoration:underline; font-size: 18px;"].concat(n))},e.addToFiredEvents=function(t,i,n){e.firedEvents.has(t)||e.firedEvents.set(t,new Map);var r=e.firedEvents.get(t);r&&!r.has(i)&&r.set(i,[]);var o=r&&r.get(i);o&&o.push.apply(o,n)},e.prototype.buildCommonFields=function(){var e=r.Profiler.get();return{sk:e.identity.siteKey,pk:e.identity.publisherKey,uid:e.identity.userId,sid:e.identity.sessionId,pvid:e.identity.pageviewId,geo:e.yieldData.countryCode,r:e.referrer,bpvid:e.identity.bootstrapPageviewId,url:e.identity.url,dos:e.deviceDetails.os,dosv:e.deviceDetails.osVersion,dv:e.deviceDetails.deviceVendor,dbt:e.deviceDetails.browserType,iru:e.yieldData.isReturningUser,ibpv:e.identity.isBenchmarkPageview,ts:e.yieldData.trafficSource,db:e.deviceDetails.browser,d:e.deviceDetails.device,dp:e.deviceDetails.deviceType,mv:e.yieldData.version,scid:e.identity.supplyConfigId,res:e.deviceDetails.screenWidth+"x"+e.deviceDetails.screenHeight,aid:e.identity.articleId}},e.prototype.getTimeOffset=function(){return s.Utils.getCurrentTime(!1)-this.profile.identity.timeOffset},e.prototype.getFold=function(e){return e.isImpression&&e.browsiAd.container?e.browsiAd.iframe?s.Utils.getElementFoldNumber(e.browsiAd.iframe):s.Utils.getElementFoldNumber(e.browsiAd.container):s.Utils.getElementFoldNumber(e.ref)},e.firedEvents=new Map,e}();t.EventsService=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.FIXED="fixed",e.DYNAMIC="dynamic"}(t.SpotType||(t.SpotType={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(1),o=i(4),s=function(){function e(){var e=this;this.loaderParams=r.Utils.getLoaderParams(),this.logger=new n.Logger("SAService"),this.spots=[],this.errorCallback=function(t){return e.logger.error(t)},this.mainContentElements=r.Utils.querySelectorAll([this.loaderParams.e.mc.s],this.errorCallback),this.mainContentEndElement=this.loaderParams.e.mc.e?r.Utils.querySelector(this.loaderParams.e.mc.e,this.errorCallback):null,this.stayAwayConfigs=this.loaderParams.e.sa||[],this.maxSaDistance=this.stayAwayConfigs.reduce(function(e,t){return e.d<t.d?t:e},{e:"",d:0}).d,this.stayAwayElements=[],this.scanDomForSA()}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.setSpots=function(e){this.spots=e},e.prototype.getStayAwayElementsList=function(){return this.stayAwayElements.map(function(e){return{element:e.element,distance:e.stayAwayDistance,inMainContent:e.isInMainContent}})},e.prototype.scanDomForSA=function(){var e=this;this.stayAwayConfigs.forEach(function(t){r.Utils.querySelectorAll([t.e],e.errorCallback).map(function(e){return{sa:{element:e,distance:t.d},config:t}}).forEach(function(t){e.upsertStayAwayElement(t.sa.element,t,!1)})})},e.prototype.scanDomForLazySA=function(e,t){var i=this;this.logger.info("re-scanning dom for SA");var n=r.Utils.getPositionFallback(e);this.stayAwayConfigs.forEach(function(e){r.Utils.querySelectorAll([e.e],i.errorCallback).filter(function(e){return i.shouldStayAwayFrom(e,n,t)}).map(function(t){return{sa:{element:t,distance:e.d},config:e}}).forEach(function(e){i.upsertStayAwayElement(e.sa.element,e,!0)})})},e.prototype.shouldStayAwayFrom=function(e,t,i){return Math.abs(r.Utils.getPositionFallback(e)-t)<=this.maxSaDistance&&(!i||r.Utils.isDescendantElement(this.mainContentElements,e))},e.prototype.upsertStayAwayElement=function(e,t,i){var n=this.stayAwayElements.find(function(t){return t.element===e});if(n)return this.updateSaElement(e,n),null;var r=this.insertSaElement(e,t.sa,i);return void 0!==t.config.e?this.logger.debug(i?"Lazy ":"","Added",r,"By Config: ",t):this.logger.debug(i?"Lazy ":"","Added",r),r},e.prototype.updateSaElement=function(e,t){var i=Object.assign({},t);!t.isValid&&this.isSaValid(e)&&(t.isLazy=!0),t.top=this.getPositionFromTop(e),t.height=e.getBoundingClientRect().height,t.isValid=this.isSaValid(e),t.isInMainContent=r.Utils.isDescendantElement(this.mainContentElements,e),i.top===t.top&&i.height===t.height&&e.style.display===t.element.style.display||this.logger.debug("Updated: ",i," TO: ",t)},e.prototype.insertSaElement=function(e,t,i){var n=e.getBoundingClientRect(),o={element:e,top:this.getPositionFromTop(e),height:n.height,stayAwayDistance:t.distance,isLazy:i,isInMainContent:r.Utils.isDescendantElement(this.mainContentElements,e),isValid:this.isSaValid(e)};return this.stayAwayElements.push(o),o},e.prototype.getPositionFromTop=function(e){return this.shouldUseNewCalculations()?r.Utils.getPositionFallback(e):r.Utils.getElementPosition(e).y},e.prototype.isSaValid=function(e){return r.Utils.isVisible(e)&&!r.Utils.isPositionFixed(e)},e.prototype.shouldUseNewCalculations=function(){return!!this.loaderParams.e.sapc},e.prototype.validateSa=function(e){return!this.shouldUseNewCalculations()||e.isValid},e.prototype.isElementContainedInSa=function(e,t){return this.shouldUseNewCalculations()&&r.Utils.isPositionContained(e,t)},e.prototype.isStayAwayViolated=function(e){return this.shouldUseNewCalculations()&&this.scanDomForLazySA(e.ref,e.type===o.SpotType.DYNAMIC),this.isStayAwayForAllEmbedTypes(e.ref,e.compatibleSizes,e.type===o.SpotType.DYNAMIC)},e.prototype.isStayAwayForAllEmbedTypes=function(e,t,i){var n=r.Utils.getEmbedTypesFromSizes(t),o=n.includes("break"),s=n.includes("wrapped");if(o){var a=this.isStayAwayElementForBreak(e,i);if("invalid"===a.status)return a;if(s)for(var d=t.length,l=void 0;d--;)if("invalid"===(l=this.removeViolatingWrappedEmbeddings(e,t[d],i)).status&&t.splice(d,1),0===t.length)return l}else if(s)for(d=t.length,l=void 0;d--;)if("invalid"===(l=this.removeViolatingWrappedEmbeddings(e,t[d],i)).status&&t.splice(d,1),0===t.length)return l;return{status:"valid"}},e.prototype.removeViolatingWrappedEmbeddings=function(e,t,i){var n=t.optionalEmbeddings.indexOf("wrapped");if(n>-1){var r=this.isStayAwayElementForWrap(e,t,i);if("invalid"===r.status)return t.optionalEmbeddings.splice(n,1),t.optionalEmbeddings.length>0?{status:"valid"}:r}return{status:"valid"}},e.prototype.isStayAwayElementForWrap=function(e,t,i){var n=this;if(this.stayAwayElements.length>0){var o=this.stayAwayElements.find(function(o){if(i&&!o.isInMainContent)return!1;if(n.isElementContainedInSa(o.element,e))return!0;var s=r.Utils.calculateDistanceBetween(e,o.element);if(r.Utils.isPositionedAfter(o.element,e)){var a=r.Utils.isContainedElement(e,o.element)?0:r.Utils.getMaxWrappingOffsetDistance(e,t);s+=e.getBoundingClientRect().height+a}var d=s<=o.stayAwayDistance;return n.validateSa(o)&&r.Utils.isElement(o.element)&&d});return o&&o.element?{status:"invalid",message:"stay away violation",element:o.element}:{status:"valid"}}return{status:"valid"}},e.prototype.isStayAwayElementForBreak=function(e,t){var i=this;if(this.stayAwayElements.length>0){var n=this.stayAwayElements.find(function(n){if(t&&!n.isInMainContent)return!1;if(i.isElementContainedInSa(n.element,e))return!0;var o=r.Utils.calculateDistanceBetween(e,n.element)+(r.Utils.isPositionedAfter(n.element,e)&&!r.Utils.isContainedElement(e,n.element)?e.getBoundingClientRect().height:0)<=n.stayAwayDistance;return i.validateSa(n)&&r.Utils.isElement(n.element)&&o});return n&&n.element?{status:"invalid",message:"stay away violation",element:n.element}:{status:"valid"}}return{status:"valid"}},e.prototype.isStayAwayElement=function(e){var t=this;if(this.stayAwayElements.length>0){var i=this.stayAwayElements.find(function(i){if(!i.isInMainContent)return!1;if(t.isElementContainedInSa(i.element,e))return!0;var n=r.Utils.calculateDistanceBetween(e,i.element)<=i.stayAwayDistance;return t.validateSa(i)&&r.Utils.isElement(i.element)&&n});return i&&i.element?{status:"invalid",message:"stay away violation",element:i.element}:{status:"valid"}}return{status:"valid"}},e}();t.default=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(1),o=i(2),s=i(3),a=i(4),d=function(){function e(){var e=this;this.logger=new n.Logger("LazySpots"),this.profile=o.Profiler.get(),this.lazySpots=[],this.lazySpotsLocations=[],this.lazyDynamicConfig=this.profile.lazySpots,this.lazyFixedStartIndex=this.profile.fixedSpotsConfig&&this.profile.fixedSpotsConfig.ll?this.profile.fixedSpotsConfig.ll:-1,this.lazyStatus={lastPosition:-1,positionListenerActive:!1,expectedNextPosition:-1,scrollDirection:"up",previousTime:-1},this.lazySpotsListener=r.Utils.throttle(function(){return e.checkLocationAndFetch()},100),this.postMovementTimeoutActive=!1,this.serviceActive=!1,this.userPositionInterval=null}return e.get=function(){return e._instance||(this._instance=new e),e._instance},e.isLazyConfiguredForSpotType=function(e,t){return!!(e===a.SpotType.DYNAMIC&&t.lazySpots||e===a.SpotType.FIXED&&t.fixedSpotsConfig.ll)},e.prototype.getThresholdMidPoint=function(e){if(e.isLazyLoading){e.offsetTop=r.Utils.getElementCoordinates(e.ref).top;var t=this.getThresholdLocation(e);return Math.floor(e.offsetTop-.5*(e.offsetTop-t))}return r.Utils.getScrollingDistance()},e.prototype.isLazy=function(e){return e.type===a.SpotType.FIXED?this.lazyFixedStartIndex>-1&&this.isAfterFirstConfiguredFold(e)&&e.typeIndex>=this.lazyFixedStartIndex:this.isAfterFirstConfiguredFold(e)&&e.typeIndex>=this.lazyDynamicConfig.fai},e.prototype.isAfterFirstConfiguredFold=function(e){return r.Utils.getElementFoldNumber(e.ref)>=this.lazyDynamicConfig.ff},e.prototype.subscribe=function(e,t){this.serviceActive||this.startService(),this.isSpotMissed(e)&&this.handleAdRequestBlock(e),e.offsetTop=r.Utils.getElementCoordinates(e.ref).top;var i=this.getThresholdLocation(e);this.logger.info(e.type+" spot "+e.typeIndex+" at "+e.offsetTop+" will start at "+i.toFixed(2)),this.lazySpots.push({spot:e,approvalsCount:0,thresholdLocation:i,fetchCallback:t}),this.lazySpotsLocations=this.lazySpots.sort(function(e,t){return e.spot.adIndex-t.spot.adIndex}).map(function(e){return{t:e.thresholdLocation,l:e.spot.offsetTop}}),this.fetchChecking()},e.prototype.unsubscribe=function(e){this.serviceActive&&this.lazySpots.length>0&&(this.logger.debug("Stopping subscription for "+e.length+" spots: ",e),this.lazySpots=this.lazySpots.filter(function(t){return!e.includes(t.spot)}),this.lazySpots.length||this.stopService())},e.prototype.getThresholdLocation=function(e){return e.offsetTop-r.Utils.getScreenSize().h*this.lazyDynamicConfig.t},e.prototype.stopService=function(){this.logger.info("stopping service"),window.top.removeEventListener("scroll",this.lazySpotsListener),this.userPositionInterval&&clearInterval(this.userPositionInterval),this.serviceActive=!1,this.lazyStatus=this.getLazyStatus(!0),this.fetchChecking()},e.prototype.startService=function(){this.logger.info("starting service"),this.lazyStatus=this.getLazyStatus(!0),window.top.addEventListener("scroll",this.lazySpotsListener),this.startUserPositionInterval(),this.serviceActive=!0},e.prototype.getLazyStatus=function(e){var t=r.Utils.getScrollPosition().bottom,i=Date.now(),n=e?0:t-this.lazyStatus.lastPosition,o=e?0:i-this.lazyStatus.previousTime,s=e||this.lazyStatus.lastPosition<=t?"down":"up",a=this.lazyDynamicConfig.aft/o;return{scrollDirection:s,expectedNextPosition:0===o?t:t+n*a,previousTime:i,lastPosition:t,positionListenerActive:!e&&this.lazyStatus.positionListenerActive}},e.prototype.checkLocationAndFetch=function(){this.lazyStatus.positionListenerActive||this.startUserPositionInterval(),this.fetchChecking()},e.prototype.startUserPositionInterval=function(){var e=this;this.lazyStatus=this.getLazyStatus(),this.lazyStatus.positionListenerActive||(this.userPositionInterval=setInterval(function(){if(e.lazyStatus=e.getLazyStatus(),e.logger.debug("direction: ",e.lazyStatus.scrollDirection.toString(),"at ",r.Utils.getScrollPosition().bottom.toFixed(2),"spots threshold: ",e.lazySpotsLocations),e.noMovement()&&!e.postMovementTimeoutActive){var t=e.lazyStatus.lastPosition;setTimeout(function(){e.postMovementTimeoutActive=!1,t===e.lazyStatus.lastPosition&&(e.userPositionInterval&&clearInterval(e.userPositionInterval),e.lazyDynamicConfig.su&&e.fetchChecking(!0),e.lazyStatus.positionListenerActive=!1,e.logger.debug("positionInterval stopped, static user"))},500),e.postMovementTimeoutActive=!0}},100)),this.lazyStatus.positionListenerActive=!0,this.logger.debug("positionInterval started")},e.prototype.noMovement=function(){return this.lazyStatus.lastPosition===this.lazyStatus.expectedNextPosition},e.prototype.fetchChecking=function(e){var t=this;if("down"===this.lazyStatus.scrollDirection)for(var i=0,n=this.lazySpots;i<n.length;i++){var r=n[i];if(this.isSpotMissed(r.spot))this.handleAdRequestBlock(r.spot),this.zeroApprovalsCount(r);else if(this.isUserInThreshold(r)){if(this.logger.debug("user in threshold of "+r.spot.type+" spot "+r.spot.typeIndex),this.isExpectedNextPositionOk(r)){r.approvalsCount++,(this.approvalsTargetReached(r)||e)&&(this.logger.info(r.spot.type+" spot "+r.spot.typeIndex+" is good for fetching ,"+r.approvalsCount+" /"+this.lazyDynamicConfig.ac),r.fetchCallback(),this.lazySpots.splice(this.lazySpots.indexOf(r),1),this.lazySpots.length||this.stopService());break}this.zeroApprovalsCount(r)}else this.zeroApprovalsCount(r)}else this.lazySpots.forEach(function(e){return t.zeroApprovalsCount(e)})},e.prototype.isSpotMissed=function(e){return r.Utils.getElementCoordinates(e.ref).top<=this.lazyStatus.lastPosition},e.prototype.handleAdRequestBlock=function(e){e.adRequestBlockedSent||(this.logger.debug(e.type+" spot "+e.typeIndex+" at position "+r.Utils.getElementCoordinates(e.ref).top+" missed, current position: "+r.Utils.getScrollPosition().bottom),s.EventsService.get().sendAdBlockedEvent(e,"lazy_ad_missed",""+r.Utils.getCurrentFoldDecimal()))},e.prototype.zeroApprovalsCount=function(e){e.approvalsCount>0&&this.logger.debug("approval count reset"),e.approvalsCount=0},e.prototype.isUserInThreshold=function(e){var t=r.Utils.getElementCoordinates(e.spot.ref).top;return this.lazyStatus.lastPosition<t&&this.lazyStatus.lastPosition>e.thresholdLocation},e.prototype.isExpectedNextPositionOk=function(e){return this.lazyStatus.expectedNextPosition<r.Utils.getElementCoordinates(e.spot.ref).top},e.prototype.approvalsTargetReached=function(e){return this.logger.debug("approval count is now "+e.approvalsCount+" and approvalsCountTarget is "+this.lazyDynamicConfig.ac),e.approvalsCount>=this.lazyDynamicConfig.ac},e}();t.default=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),r=i(2),o=i(0),s=function(){function e(t){this.wrapperId=e.wrapperIdPrefix+"_ai_"+t.adIndex+"_ati_"+(t.attemptIndex?t.attemptIndex:1)+"_rc_"+(t.refresh.active?t.refresh.count:0),this.containerId=e.containerIdPrefix+"_ai_"+t.adIndex+"_ati_"+(t.attemptIndex?t.attemptIndex:1)+"_rc_"+(t.refresh.active?t.refresh.count:0),t.setDomId(this.wrapperId)}return e.prototype.appendAd=function(e,t){if(e.ref.parentNode){if(e.tableConfiguration){var i=e.tableConfiguration.mainTd.cloneNode();i.appendChild(t),e.ref.parentNode.insertBefore(i,e.ref)}else e.ref.parentNode.insertBefore(t,e.ref);n.Utils.reportNewBrowsiAd(t)}},e.isEmbeddedByBrowsi=function(t){var i=!1;return Array.from(document.querySelectorAll('div[id^="'+e.wrapperIdPrefix+'"]')).forEach(function(e){!i&&n.Utils.isPositionContained(e,t)&&(i=!0)}),i},e.injectMoat=function(e){var t=this;if(e.browsiAd.wrapper){var i={moatClientLevel1:e.providerName?e.providerName:"NA",moatClientLevel2:r.Profiler.get().identity.siteKey,moatClientLevel3:n.Utils.getElementFoldNumber(e.browsiAd.wrapper),moatClientLevel4:e.adIndex},o=this.moatUrl+"#"+n.Utils.toUrlParams(i);this.logger.info("injecting moat for spot "+e.adIndex),n.Utils.appendScript(o,e.browsiAd).catch(function(e){return t.logger.error("moat failed: "+o)})}},e.logger=new o.Logger("Embedder"),e.wrapperIdPrefix="browsi_adWrapper",e.containerIdPrefix="browsi_adContainer",e.moatUrl="//z.moatads.com/browsidisplay14489870757/moatad.js",e}();t.Embedder=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(3),o=i(2),s=function(){function e(){var e=this;this.logger=new n.Logger("Focus"),this.profile=o.Profiler.get(),this.isSubscribed=!0,this.isHidden="hidden"===document.visibilityState,this.isHidden&&r.EventsService.get().sendFocusChangedEvent(!1),this.subscribe(function(t){e.onFocusChanged(t)})}return e.prototype.subscribe=function(e){this.profile.debugMode&&this.listenToDemoVisibilityChange(e),document.addEventListener("visibilitychange",function(){e("hidden"===document.visibilityState)})},e.prototype.unsubscribe=function(){return this.isSubscribed=!1,!0},e.prototype.waitForUserFocusWithAdBlock=function(e){return this.profile.blockAdRequestOnOOF?(this.isHidden&&!e.adRequestBlockedSent&&r.EventsService.get().sendAdBlockedEvent(e,"out_of_focus",""),this.waitForUserFocus()):Promise.resolve()},e.prototype.waitForUserFocus=function(){var e=this;return new Promise(function(t){if(e.subscribe(function(e){e||t()}),!e.isHidden)return t()})},e.prototype.onFocusChanged=function(e){var t=this;setTimeout(function(){var i="hidden"===document.visibilityState;e===i&&t.isHidden!==i&&(t.isHidden=i,t.logger.info("focus changed. in focus: "+!t.isHidden),r.EventsService.get().sendFocusChangedEvent(!i))},1e3)},e.prototype.listenToDemoVisibilityChange=function(e){var t=this;document.addEventListener("demoVisibilityChange",function(){t.isHidden=!!window._isHidden,e(t.isHidden)})},e.instance=new e,e}();t.Focus=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(2),o=i(1),s=i(6),a=i(4),d=i(20),l=i(21),c=i(12),p=function(){function e(){this.logger=new n.Logger("YieldClient"),this.profile=r.Profiler.get()}return e.get=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.processSpots=function(e){var t=this;if(this.profile.potentialSpots){var i=this.createGetDemandScriptTag(e,d.DemandRequestType.SRA,this.getDemandCallback.bind(this));window.top.document.body.appendChild(i)}else e.forEach(function(e){var i=t.createGetDemandScriptTag([e],d.DemandRequestType.SINGLE,t.getDemandCallback.bind(t));window.top.document.body.appendChild(i)})},e.prototype.processSingleSpot=function(e){this.logger.info("attemptIndex",e.attemptIndex);var t=this.createGetDemandScriptTag([e],d.DemandRequestType.SINGLE,this.getDemandCallback.bind(this));window.top.document.body.appendChild(t)},e.prototype.getDemandCallback=function(e,t){var i=this;"sra"===e.rt&&(e=c.SRAResponseManager.preProcessSRAResponse(e,t),this.logger.info("getDemand returned  SRA response ",e)),t.forEach(function(n){o.Utils.getElementFoldNumber(n.ref)>=2&&!o.Utils.isEngagedUser()?i.waitForUserEngagement().then(function(){return l.DemandManager.get().processResponse(n,e,t)}):l.DemandManager.get().processResponse(n,e,t)})},e.prototype.nextWaterfallStep=function(e){e.isRefreshing()?e.endRefreshProcess():(e.attemptIndex++,this.processSingleSpot(e))},e.prototype.waitForUserEngagement=function(){var e=this;return new Promise(function(t){var i=function(){e.logger.info("detected scroll, fetching"),window.top.removeEventListener("scroll",i),e.profile.engagedUsers.engaged=!0,t()};window.top.addEventListener("scroll",i)})},e.prototype.createGetDemandScriptTag=function(e,t,i){var n="",r=document.createElement("script");switch(r.setAttribute("crossorigin","anonymous"),r.async=!0,t){case d.DemandRequestType.SRA:n="__b_gdc_sra",r.src=this.buildGetSRADemandUrl(e,n);break;case d.DemandRequestType.SINGLE:if(1===e.length){var o=e[0];n="__b_gdc_ad_"+o.adIndex,r.src=this.buildGetDemandUrl(o,n)}else this.logger.error("Error while creating getDemand script tag: Invalid spots list",e)}return window.top[n]=function(t){return i(t,e)},r},e.prototype.buildGetSRADemandUrl=function(e,t){var i=r.Profiler.get(),n={sk:i.identity.siteKey,pvId:i.identity.pageviewId,sId:i.identity.sessionId,uId:i.identity.userId,mi:i.spotsConfig.ms,u:document.location.href,fmi:i.fixedSpotsConfig?i.fixedSpotsConfig.mi:0,dd:this.buildDeviceData(i),c:t,aId:i.identity.articleId,mch:o.Utils.getMainContentSize(i.domData),pl:o.Utils.getPageHeight(),pps:this.buildPotentialSpotsParams(e)};return"//"+i.yieldData.host+"/v2/demand/sra/desktop?"+o.Utils.toUrlParams(n)},e.prototype.buildGetDemandUrl=function(e,t){var i=r.Profiler.get();this.logger.info("AttemptIndex: ",e.attemptIndex);var n={sk:i.identity.siteKey,pvId:i.identity.pageviewId,sId:i.identity.sessionId,uId:i.identity.userId,u:document.location.href,dd:this.buildDeviceData(i),ad:this.buildAdData(e),c:t,eul:s.default.get().getThresholdMidPoint(e),aId:i.identity.articleId,mch:o.Utils.getMainContentSize(i.domData),pl:o.Utils.getPageHeight()};return"//"+i.yieldData.host+"/v2/demand/desktop?"+o.Utils.toUrlParams(n)},e.prototype.buildAdData=function(e){return{atI:e.attemptIndex,ai:e.adIndex,f:o.Utils.getElementFoldNumber(e.ref),rc:e.refresh.count,ll:e.isLazyLoading,dp:e.type===a.SpotType.DYNAMIC,et:e.getExpectedEmbedding(),ot:o.Utils.getElementPosition(e.ref).y,di:e.demandIndex}},e.prototype.buildDeviceData=function(e){return{o:e.deviceDetails.os,d:e.deviceDetails.device,t:e.deviceDetails.deviceType,b:e.deviceDetails.browser,sh:e.deviceDetails.screenHeight}},e.prototype.buildPotentialSpotsParams=function(e){return e.map(this.buildSRAPotentialSpot.bind(this))},e.prototype.buildSRAPotentialSpot=function(e){return{ai:e.adIndex,f:o.Utils.getElementFoldNumber(e.ref),ll:e.isLazyLoading,dp:e.type===a.SpotType.DYNAMIC,et:e.getExpectedEmbedding(),ot:o.Utils.getElementPosition(e.ref).y,eul:s.default.get().getThresholdMidPoint(e)}},e}();t.YieldClient=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),r=i(3),o=i(2),s=i(26),a=i(11),d=function(){function e(e,t){this.spot=e,this.providerName=t,this.hasFluidSizeSupport=!1,this.profile=o.Profiler.get();var i=n.Utils.getLoaderParams().e.pkv;this.browsiViewability50Key=i.v50,this.browsiViewability100Key=i.v100}return e.prototype.getAdUnitPath=function(e){return"/"+e.a.pubID+"/"+e.au},e.prototype.addGPTScriptTag=function(e){var t=this;return new Promise(function(i,n){if(e&&e.win){var r=e.win.document.createElement("script");r.async=!0,r.setAttribute("src","https://securepubads.g.doubleclick.net/tag/js/gpt.js"),r.addEventListener("load",function(){i(e)}),e.win.document.head.appendChild(r)}else t.logger.error("failed to append gpt script tag"),n(e)})},e.prototype.expandAd=function(e,t,i){var n=this;e.selectedSize?(e.handleRefreshedDone(),e.expand(e.selectedSize).then(function(o){e.selectedSize?(e.isImpression=!0,e.insertAdMarking(),r.EventsService.get().sendAdImpression(e,n.providerName,e.selectedSize.selectedEmbedding),"generic_js"!==n.providerName&&n.isAdInViewport().then(function(t){t&&n.sendAdInViewEvent(e)}),e.updateInSpotEngineTest(),n.logger.info("["+o.w+"X"+o.h+"] "+n.providerName+" ad created: ",e.browsiAd.wrapper),e.subscribeToViewabilityService(),t(Object.assign({status:"success"},i||{}))):t({status:"failure"})})):t({status:"failure"})},e.prototype.isAdInViewport=function(){if(!this.profile.adInViewport||this.spot.refresh.count>0)return Promise.resolve(!1);var e=50+(this.spot.browsiAd.admarking?n.Utils.getElementSize(this.spot.browsiAd.admarking).h:0),t=this.spot.browsiAd.wrapper;return t?n.Utils.getElementSize(t).h>e?Promise.resolve(!0):new Promise(function(i){var r=new s.default(t);r.addResizeListener(function(){if(n.Utils.getElementSize(t).h>e)return r.removeResizeListener(),i(!0)})}):Promise.resolve(!1)},e.prototype.sendAdInViewEvent=function(e){if(e.browsiAd&&e.browsiAd.wrapper){var t=e.browsiAd.wrapper,i=a.ViewabilityService.get().inViewPercentage({getCoords:function(){return n.Utils.getElementCoordinates(t)},getHeight:function(){return n.Utils.getElementSize(t).h}});i&&r.EventsService.get().sendAdInViewport(e,i)}},e.prototype.buildSizesArray=function(){var e=this;return this.spot.isRefreshing()&&this.spot.selectedSize?this.hasFluidSizeSupport&&n.Utils.isFluidSize(this.spot.selectedSize)?["fluid"]:[this.spot.selectedSize.w,this.spot.selectedSize.h]:this.spot.compatibleSizes.filter(function(t){return e.hasFluidSizeSupport||!e.hasFluidSizeSupport&&!n.Utils.isFluidSize(t)}).map(function(t){return e.hasFluidSizeSupport&&n.Utils.isFluidSize(t)?["fluid"]:[t.w,t.h]})},e.prototype.isBrowsiSlot=function(e,t){return e.slot&&e.slot.getSlotElementId()===t},e.prototype.addKeyValues=function(e,t){e.od&&(e.od[50]&&e.od[50].sp&&t.setTargeting(this.browsiViewability50Key,this.getBrowsiViewability(e.od[50])),e.od[100]&&e.od[100].sp&&t.setTargeting(this.browsiViewability100Key,this.getBrowsiViewability(e.od[100]))),this.spot.refresh.requested&&e.ri.kv&&t.setTargeting("browsiRefresh","true"),e.kv&&e.kv.forEach(function(e){t.setTargeting(e.k,e.v)})},e.prototype.getBrowsiViewability=function(e){return e.p&&e.p>=0?(Math.floor(10*e.p)/10).toFixed(2):"NA"},e.prototype.runPreAuction=function(e,t){var i=n.Utils.getExternalFlowHandler("preAuction");if(i){this.logger.info("invoking preAuction");try{i(e,t)}catch(e){this.logger.error("preAuction failed",e)}}},e.prototype.getAdSelector=function(){return this.spot.browsiAd.container&&this.spot.browsiAd.container.id||""},e}();t.Provider=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(1),o=i(8),s=function(){function e(){var e=this;this.logger=new n.Logger("Viewability"),this.pendingObjects=[],this.viewabilityCheckInterval=150,this.elementsLocationUpdateInterval=500,this.viewabilityCheck=this.throttle(function(t){var i=r.Utils.getScrollPosition();0===e.pendingObjects.length?(window.top.removeEventListener("scroll",e.viewabilityCheck),e.logger.info("viewability check has stopped, no more elements")):e.pendingObjects.forEach(function(t){return e.checkElementViewability(t,i)})},this.viewabilityCheckInterval),this.elementsLocationCheck=this.throttle(function(t){0===e.pendingObjects.length&&window.top.removeEventListener("scroll",e.elementsLocationCheck)},this.elementsLocationUpdateInterval),o.Focus.instance.subscribe(this.onFocusChanged.bind(this))}return e.get=function(){return e._instance||(this._instance=new e),e._instance},e.prototype.subscribe=function(e){var t=this;this.pendingObjects.push(e),this.pendingObjects.forEach(function(e){return t.checkElementViewability(e,r.Utils.getScrollPosition())}),this.startWatching()},e.prototype.startWatching=function(){window.top.addEventListener("scroll",this.elementsLocationCheck),window.top.addEventListener("scroll",this.viewabilityCheck)},e.prototype.checkElementViewability=function(e,t){var i=this;if(this.isInView(e,t)){if(r.Utils.isNullOrUndefined(e.metrics.startTime)){e.metrics.startTime=Date.now(),this.logger.info(e.root()," is in view");var n=e.refreshInfo.shouldRefresh,o=setInterval(function(e){if(i.pendingObjects.includes(e)){var s=r.Utils.getScrollPosition();i.isInView(e,s)?(r.Utils.isNullOrUndefined(e.metrics.startTime)&&(e.metrics.startTime=Date.now()),e.metrics.duration=i.getViewedDuration(e),i.logger.debug(e.root(),"is in view for "+e.metrics.duration),n&&e.metrics.duration>=e.refreshInfo.rate&&(i.logger.info(e.root(),": "+e.metrics.duration+"ms have passed.starting to refresh"),clearInterval(o),i.pendingObjects.splice(i.pendingObjects.indexOf(e),1),e.refreshInfo.doRefresh()),i.shouldSendViewedImpression(e)&&(i.handleViewed(e,t),n||clearInterval(o))):(i.handleOUtOfView(e),clearInterval(o))}},this.viewabilityCheckInterval,e)}else e.metrics.duration=this.getViewedDuration(e);this.shouldSendViewedImpression(e)&&this.handleViewed(e,t)}else e.metrics.startTime&&this.handleOUtOfView(e)},e.prototype.handleOUtOfView=function(e){e.metrics.startTime&&(this.logger.debug(e.root()," is out of view after "+this.getViewedDuration(e)),e.metrics.startTime=null,e.metrics.duration=-1)},e.prototype.handleViewed=function(e,t){e.metrics.viewed=!0,e.refreshInfo.shouldRefresh?this.logger.debug(e.root(),"starting to count for refresh ("+e.metrics.duration+"ms out of "+e.refreshInfo.rate+"ms)"):this.pendingObjects.splice(this.pendingObjects.indexOf(e),1),this.logger.debug(e.root(),"after "+e.metrics.duration+"ms"),e.sendViewedImpression(Math.round(this.inViewPercentage(e,t)))},e.prototype.getViewedDuration=function(e){return e.metrics.startTime?Date.now()-e.metrics.startTime:-1},e.prototype.shouldSendViewedImpression=function(e){return!e.metrics.viewed&&e.metrics.duration>=e.conf.duration},e.prototype.throttle=function(e,t){var i=!1;return function(n){i||(e(n),i=!0,setTimeout(function(){i=!1,e(n)},t))}},e.prototype.isInView=function(e,t){if(!e.runCondition()||o.Focus.instance.isHidden)return!1;var i=this.inViewPercentage(e,t),n=i>=e.conf.minViewInitiator;return i>0&&this.logger.debug(e.root()," percentage in view: "+i.toFixed(2)+" , minViewInitiator: "+e.conf.minViewInitiator+", in view: "+n),n},e.prototype.onFocusChanged=function(e){e||this.viewabilityCheck(null)},e.prototype.inViewPercentage=function(e,t){var i=t||r.Utils.getScrollPosition(),n=e.getCoords().top,o=e.getHeight();if(i.top<=n&&i.bottom>n){var s=i.bottom-n;return 100*Math.min(Number(s/o),1)}if(i.top>n&&i.top<n+o){s=n+o-i.top;return 100*Math.min(Number(s/o),1)}return 0},e.prototype.unsubscribe=function(e){this.pendingObjects=this.pendingObjects.filter(function(t){return t.root()!==e})},e}();t.ViewabilityService=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4),r=i(0),o=i(6),s=i(2),a=i(1),d=function(){function e(t,i){this.logger=new r.Logger("SRAResponseManager"),this.response=t,this.spots={},this.spots[n.SpotType.DYNAMIC]=i.filter(function(e){return e.type===n.SpotType.DYNAMIC}).sort(function(e,t){return t.typeIndex-e.typeIndex}),this.spots[n.SpotType.FIXED]=i.filter(function(e){return e.type===n.SpotType.FIXED}).sort(function(e,t){return t.typeIndex-e.typeIndex}),this.configs={},this.configs[n.SpotType.DYNAMIC]=e.generateConfigArray(t.c),this.configs[n.SpotType.FIXED]=e.generateConfigArray(t.fc)}return e.prototype.pop=function(e,t){var i=this.spots[e.type].indexOf(e),n=this.configs[e.type].findIndex(function(e){return e===t});return i>-1&&n>-1?(e.demandIndex=this.configs[e.type][n].demandIndex,t.od=this.getPrediction(e),o.default.get().unsubscribe(this.spots[e.type].slice(i)),this.spots[e.type].length=i,this.configs[e.type].length=n,this.logger.info(e.type+" spot "+e.typeIndex+" matched demand "+e.demandIndex,t),t):(this.logger.debug("Couldn't match "+e.type+" spot "+e.typeIndex+" to response",t),null)},e.prototype.peek=function(e){var t=this.configs[e.type].length;return t>0&&this.spots[e.type].includes(e)?this.configs[e.type][t-1]:(this.logger.debug("No available demand response for "+e.type+" spot "+e.typeIndex),null)},e.prototype.getPrediction=function(e){return this.response.ods&&this.response.ods[e.adIndex]},e.generateConfigArray=function(e){var t=[];for(var i in Object.keys(e))t.push(Object.assign({},e[i],{demandIndex:Number(i)}));return t.sort(function(e,t){return t.demandIndex-e.demandIndex}),t},e.preProcessSRAResponse=function(e,t){var i=s.Profiler.get().spotsConfig,r=s.Profiler.get().fixedSpotsConfig,o=i&&i.ms||0,d=r&&r.mi||0;o=Math.min(o,t.filter(function(e){return e.type===n.SpotType.DYNAMIC}).length),d=Math.min(d,t.filter(function(e){return e.type===n.SpotType.FIXED}).length);var l=a.Utils.clone(e);delete l.c[-1],delete l.fc[-1];for(var c=0;c<o;c++)e.c[c]||(l.c[c]=a.Utils.clone(e.c[-1]));for(var p=0;p<d;p++)e.fc[p]||(l.fc[p]=a.Utils.clone(e.fc[-1]));return l},e}();t.SRAResponseManager=d},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(10),s=i(3),a=i(0),d=i(1),l=i(8),c=function(e){function t(t){var i=e.call(this,t,"dfp")||this;return i.logger=new a.Logger("DFP"),i.hasFluidSizeSupport=!0,i}return r(t,e),t.isValidSize=function(e){return Array.isArray(e)?e[0]>this.minAdSize&&e[1]>this.minAdSize:e.w>this.minAdSize&&e.h>this.minAdSize},t.prototype.fetch=function(e,t){var i=this;return new Promise(function(n){i.logger.info("fetching spot "+i.spot.adIndex,i.spot),t.appendAndGetWrapper(i.spot).then(function(e){return i.addGPTScriptTag(e)}).then(function(t){return i.pushGoogleTagCommands(t,e)}).then(function(e){return n(e)}).catch(function(e){i.logger.error("fetching failed: ",e),n({status:"error"})})})},t.prototype.pushGoogleTagCommands=function(e,t){var i=this;return new Promise(function(n){l.Focus.instance.waitForUserFocusWithAdBlock(i.spot).then(function(){var r=i.buildSizesArray(),o=i.getGoogletag(e);o.cmd.push(function(){var a=i.getAdSelector(),d=o.defineSlot("/"+t.c.a.pubID+"/"+t.c.au,r,a).addService(o.pubads());i.addKeyValues(t,d),i.logger.info("spot "+i.spot.adIndex+", definedSlot: "+d.getAdUnitPath()+", sizes:"+JSON.stringify(r)+", keyValue: "+JSON.stringify(d.getTargetingMap()));var l=setTimeout(function(){return i.handleAdMatchFalse(d,n)},t.c.t);o.pubads().addEventListener("slotRenderEnded",function(e){return i.slotRenderEndedEvent(e,n,l,d)}),i.display(o,a,d,t,!!e.iframe),s.EventsService.get().sendAdRequest(i.spot,i.providerName)})})})},t.prototype.handleAdMatchFalse=function(e,t){(s.EventsService.get().sendAdMatchedEvent(this.spot,"dfp",!1),this.spot.isRefreshing())||(this.spot.isImpression=!1,this.getGoogletag(this.spot.browsiAd).destroySlots([e]));t({status:"failure"})},t.prototype.getGoogletag=function(e){return e.win&&e.win.googletag||{}},t.prototype.display=function(e,t,i,n,r){var o="false"===n.c.a.upc||!n.c.a.upc;r?(e.enableServices(),e.display(t)):(e.pubads().disableInitialLoad(),e.enableServices(),window.google_DisableInitialLoad?(e.display(t),e.pubads().refresh([i],{changeCorrelator:o})):(1===e.pubads().getSlots().length&&e.display(t),e.pubads().refresh([i],{changeCorrelator:o})))},t.prototype.slotRenderEndedEvent=function(e,t,i,n){n==e.slot&&(this.getAdSelector()===e.slot.getSlotElementId()?(this.spot.spotRenderEnded++,clearTimeout(i),this.isForcedRefresh()?this.handleFocedRefreshRenderEnded(e):this.handleRenderEnded(e,t)):this.spot.isRefreshing()&&clearTimeout(i))},t.prototype.handleFocedRefreshRenderEnded=function(e){s.EventsService.get().sendAdMatchedEvent(this.spot,"dfp",!e.isEmpty,"forced_refresh"),e.isEmpty||(s.EventsService.get().sendAdImpression(this.spot,this.providerName),this.spot.updateInSpotEngineTest())},t.prototype.handleRenderEnded=function(e,t){var i=d.Utils.getDfpEventSize(e);if(this.logger.info("dfp "+(e.isEmpty?"empty":JSON.stringify(i))+" for "+this.getAdSelector()),e.isEmpty)this.handleAdMatchFalse(e.slot,t);else{if(this.spot.setSelectedSize(i),!this.spot.selectedSize)return t({status:"error"});this.spot.providerName=this.providerName,s.EventsService.get().sendAdMatchedEvent(this.spot,"dfp",!0),d.Utils.isNullOrUndefined(this.spot.selectedSize)?(this.logger.warn("No size match for spot: ",this.spot,e),t({status:"error"})):this.expandAd(this.spot,t)}},t.prototype.isForcedRefresh=function(){return this.spot.spotRenderEnded>this.spot.attemptIndex&&!this.spot.isRefreshing()},t.minAdSize=5,t}(o.Provider);t.DFP=c},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),a=i(10),d=i(2),l=i(1),c=i(3),p=i(8),u=function(e){function t(t,i,n,r){var o=e.call(this,t,i)||this;return o.bidConfigs=o.getBidConfig(n,r,t),o.iframeDoc=null,o.logger=new s.Logger("PrebidJs"),o.profile=d.Profiler.get(),o}return r(t,e),t.prototype.fetch=function(e,t){var i=this;return new Promise(function(n){i.logger.info("fetching spot "+i.spot.adIndex,i.spot),t.appendAndGetWrapper(i.spot).then(function(e){return i.addPrebidScriptTag(e)}).then(function(t){return i.runPbjsCommands(e,t)}).then(function(e){return n(e)}).catch(function(e){"not_supported"===e?(i.logger.error("fetching failed: Prebid version "+(i.pbjsInstance?i.pbjsInstance.version:"")+" is not supported",i.pbjsInstance),c.EventsService.get().sendAdBlockedEvent(i.spot,"prebid_version_unsupported","Prebid version "+(i.pbjsInstance?i.pbjsInstance.version:"")),n({status:"not_supported"})):(i.logger.error("fetching failed: ",e),n("error"))})})},t.prototype.runPbjsCommands=function(e,t){var i=this;return new Promise(function(n,r){p.Focus.instance.waitForUserFocusWithAdBlock(i.spot).then(function(){i.handlePbjsCommands(e,t,n,r)})})},t.prototype.buildIframe=function(e,t,i){var n=e.document.createElement("iframe");return n.id=t,n.width=""+i.width,n.height=""+i.height,n.scrolling="no",n.frameBorder="0",n},t.prototype.getHighestBidById=function(e,t){var i=e[t]&&e[t].bids;return i?i.reduce(function(e,t){return e.cpm>t.cpm?e:t}):null},t.prototype.addPrebidScriptTag=function(e){var i=this;if(e.win){if(!this.profile.prebidPath)return Promise.reject("no_url");if(e.iframe)return this.injectPbjs(e),Promise.resolve(e);var n=this.getInstanceName(e);return this.pbjsInstance=e.win[n],this.logger.info("checking pbjs "+n,this.pbjsInstance),this.pbjsInstance?t.isBrowsiPbjs?(this.logger.info("using browsi existing "+n),Promise.resolve(e)):new Promise(function(t,r){i.pbjsInstance.que=i.pbjsInstance.que||[],i.pbjsInstance.que.push(function(){i.pbjsInstance.version&&0===i.pbjsInstance.version.indexOf("v0")?r("not_supported"):(i.logger.info("Using publisher "+n),t(e))})}):(this.injectPbjs(e),t.isBrowsiPbjs=!0,Promise.resolve(e))}return Promise.reject("error")},t.prototype.getInstanceName=function(e){return e.iframe?"pbjs":this.profile.prebidData&&this.profile.prebidData.g||"pbjs"},t.prototype.injectPbjs=function(e){if(e.win){this.logger.info("Injecting Browsi Pbjs"),e.win.pbjs=e.win.pbjs||{},this.pbjsInstance=e.win.pbjs,this.pbjsInstance&&(this.pbjsInstance.que=this.pbjsInstance.que||[]);var t=e.win.document.createElement("script");t.async=!0,t.setAttribute("src",this.profile.prebidPath),e.win.document.head.appendChild(t)}},t.prototype.buildAdUnit=function(e,t){var i=this;return t&&(t[50]&&t[50].sp&&this.bidConfigs.forEach(function(e){e.params[i.browsiViewability50Key]=t[50].p}),t[100]&&t[100].sp&&this.bidConfigs.forEach(function(e){e.params[i.browsiViewability100Key]=t[100].p})),{code:e,mediaTypes:{banner:{sizes:this.buildSizesArray()}},bids:this.bidConfigs}},t.prototype.getConfig=function(e,t){return o({enableSendAllBids:!0,debug:l.Utils.getLoaderParams().debug},this.getUserIdConfig(),this.getConsentManagementConfig(),t?{priceGranularity:e&&e.c.pg||"auto"}:{})},t.prototype.getUserIdConfig=function(){return this.profile.prebidData&&this.profile.prebidData.u?{userSync:JSON.parse(this.profile.prebidData.u.pj)}:{}},t.prototype.getConsentManagementConfig=function(){return this.profile.prebidData&&this.profile.prebidData.c?{consentManagement:{cmpApi:this.profile.prebidData.c.c.toLowerCase(),timeout:this.profile.prebidData.c.t,allowAuctionWithoutConsent:!0}}:{}},t.prototype.renderAd=function(e,t,i){if(e.win&&e.container&&e.container.id){var n=this.buildIframe(e.win,e.container.id,t);if((e.iframe?e.iframe.contentDocument.body:e.container).appendChild(n),this.pbjsInstance&&t.adId)return this.pbjsInstance.renderAd(n.contentWindow.document,t.adId),this.expandAd(this.spot,i);i({status:"failure"})}},t.prototype.getBidResponses=function(e){var t=this.pbjsInstance&&this.pbjsInstance.getBidResponses()[e];return t?t.bids:[]},t.prototype.sendBidRequests=function(e){var t=this,i=[];e.bids.forEach(function(e){var n={adUnit:t.getAdUnitForBidRequest(e),bidderName:e.bidder};i.push(n)}),i.length&&c.EventsService.get().sendBidRequest(i,this.spot)},t.prototype.sendBidMatchedEvents=function(e){var t=this,i=this.getBidResponses(e),n=this.getCurrentAuctionDefinition(e),r=l.Utils.getSpotCoords(this.spot),o=[];i.forEach(function(e){var i=Number(e.cpm),r=e.currency||"NA",s={w:e.width,h:e.height},a={bidderName:e.bidder,adUnit:t.getAdUnitForBidMatched(e,n),bidRate:i,currency:r,isMatched:i>0,size:s};o.push(a)}),this.getNoBids(e).forEach(function(e){var i={bidderName:e.bidder,adUnit:t.getAdUnitForBidRequest(e),bidRate:-1,currency:"NA",isMatched:!1,size:{w:-1,h:-1},reason:"no_bid"};o.push(i)}),o.length&&c.EventsService.get().sendBidMatched(o,this.spot,r)},t.prototype.getNoBids=function(e){if(this.pbjsInstance&&this.pbjsInstance.getNoBids&&"function"==typeof this.pbjsInstance.getNoBids){var t=this.pbjsInstance.getNoBids()[e];return t?t.bids:[]}return[]},t.prototype.getCurrentAuctionDefinition=function(e){return this.pbjsInstance&&this.pbjsInstance.adUnits.find(function(t){return t.code===e})||null},t.prototype.getAdUnitForBidMatched=function(e,t){if(t){var i=t.bids.find(function(t){return t.bidder===e.bidder});return i?this.getAdUnitForBidRequest(i):"NA"}return"NA"},t.prototype.getBidConfig=function(e,t,i){var n=this;return e.reduce(function(e,r){switch(r.p){case"appnexus":return e.concat(n.buildAppnexusBids(r));case"appnexus_inv_code":return r.p="appnexus",e.concat(n.buildAppnexusInvBids(r));case"adform":return e.concat(n.buildAdformBids(r));case"sovrn":return e.concat(n.buildSovrnBids(r));case"districtmdmx":return e.concat(n.buildDistrictBids(r));case"pulsepoint":return e.concat(n.buildPulsepointBids(r,i));case"aol":return e.concat(n.buildAolBids(r));case"openx":return e.concat(n.buildOpenxBids(r));case"rubicon":return e.concat(n.buildRubiconBids(r));case"smart_ad_server":return e.concat(n.buildSmartAdBids(r));case"ad_you_like":return e.concat(n.buildAdULikeBids(r));case"audiencenetwork":return e.concat(n.buildAudienceNetworkBids(r));case"criteo":return e.concat(n.buildCriteoBids(r));case"index_exchange":return e.concat(n.buildIndexExchangeBids(r,i));case"lockerdome":return e.concat(n.buildLockerdomeBids(r));case"pubmatic":return e.concat(n.buildPubmaticBids(r,i));case"brealtime":return e.concat(n.buildBrealTimeBids(r));case"sharethrough":return e.concat(n.buildSharethroughBids(r));case"sonobi":return e.concat(n.buildSonobiBids(r));case"gumgum":return e.concat(n.buildGumGumBids(r));case"triple_lift":return e.concat(n.buildTripleliftBids(r));case"across":return e.concat(n.buildAcrossBids(r));case"conversant":return e.concat(n.buildConversantBids(r));case"ias":return e.concat(n.buildIASBids(r,t));case"adkernel":return e.concat(n.buildAdKernelBids(r));case"aja":return e.concat(n.buildAjaBids(r));case"yjax":return e.concat(n.buildYjaxBids(r));case"rdn":return e.concat(n.buildRdnBids(r));case"dgads":return e.concat(n.buildDgadsBids(r));case"kargo":case"medianet":case"yieldmo":case"onemobile":case"districtm":case"gamoshi":case"aardvark":case"rtbhouse":case"playgroundxyz":return e.concat([{bidder:r.p,params:r.a}])}return e.concat([])},[])||[]},t.prototype.buildAppnexusBids=function(e){return[{bidder:"appnexus",params:{placementId:e.au}}]},t.prototype.buildAppnexusInvBids=function(e){return[{bidder:"appnexus",params:{member:e.a.memberId,invCode:e.au}}]},t.prototype.buildAdformBids=function(e){return[{bidder:"adform",params:{mid:e.au}}]},t.prototype.buildSovrnBids=function(e){return[{bidder:"sovrn",params:{tagid:e.au}}]},t.prototype.buildDistrictBids=function(e){return[{bidder:"districtmDMX",params:{id:e.au}}]},t.prototype.buildPulsepointBids=function(e,t){return t.compatibleSizes.map(function(t){return{bidder:"pulsepoint",params:{cf:l.Utils.sizeToString(t),cp:e.a.cp,ct:e.a.ct}}})},t.prototype.buildAolBids=function(e){return[{bidder:"aol",params:{placement:e.au,network:e.a.networkId}}]},t.prototype.buildOpenxBids=function(e){return[{bidder:"openx",params:{unit:e.au,delDomain:e.a.delDomain}}]},t.prototype.buildRubiconBids=function(e){var t=e.a;return t.zoneId=e.au,t.sizes=void 0,[{bidder:"rubicon",params:t}]},t.prototype.buildSmartAdBids=function(e){var t=e.a;return t.pageId=e.au,t.domain="https://prg.smartadserver.com",[{bidder:"smartadserver",params:t}]},t.prototype.buildAdULikeBids=function(e){return[{bidder:"adyoulike",params:{placement:e.au}}]},t.prototype.buildAudienceNetworkBids=function(e){return[{bidder:"audienceNetwork",params:{placementId:e.au}}]},t.prototype.buildCriteoBids=function(e){return[{bidder:"criteo",params:{zoneId:e.au}}]},t.prototype.buildIndexExchangeBids=function(e,t){return t.compatibleSizes.map(function(t){return{bidder:"ix",params:{siteId:e.au,size:[t.w,t.h]}}})},t.prototype.buildLockerdomeBids=function(e){return[{bidder:"lockerdome",params:{adUnitId:e.au}}]},t.prototype.buildPubmaticBids=function(e,t){return t.compatibleSizes.map(function(t){return{bidder:"pubmatic",params:{publisherId:e.a.adSlot||e.a.publisherId,adSlot:e.au+"@"+l.Utils.sizeToString(t)}}})},t.prototype.buildBrealTimeBids=function(e){return[{bidder:"emx_digital",params:{tagid:e.au}}]},t.prototype.buildSharethroughBids=function(e){return[{bidder:"sharethrough",params:{pkey:e.au}}]},t.prototype.buildSonobiBids=function(e){return[{bidder:"sonobi",params:{ad_unit:e.au}}]},t.prototype.buildGumGumBids=function(e){return[{bidder:"gumgum",params:{inScreen:e.au}}]},t.prototype.buildTripleliftBids=function(e){return[{bidder:"triplelift",params:{inventoryCode:e.au}}]},t.prototype.buildAcrossBids=function(e){return[{bidder:"33across",params:{siteId:e.a.siteID,productId:e.a.productID}}]},t.prototype.buildConversantBids=function(e){return[{bidder:"conversant",params:{site_id:e.a.siteID,secure:Number(e.a.secure)}}]},t.prototype.buildIASBids=function(e,t){return[{bidder:"ias",params:{pubId:e.a.pubId,adUnitPath:this.getAdUnitPath(t)}}]},t.prototype.buildAdKernelBids=function(e){return[{bidder:"adkernel",params:{host:e.a.host,zoneId:e.a.zoneId}}]},t.prototype.buildAjaBids=function(e){return[{bidder:"aja",params:{asi:e.a.asi}}]},t.prototype.buildYjaxBids=function(e){return[{bidder:"appnexus",params:{placementId:e.a.placementId,usePaymentRule:e.a.usePaymentRule}}]},t.prototype.buildRdnBids=function(e){return[{bidder:"rdn",params:{adSpotId:e.a.adSpotId}}]},t.prototype.buildDgadsBids=function(e){return[{bidder:"dgads",params:{location_id:e.a.location_id,site_id:e.a.site_id}}]},t.prototype.getAdUnitForBidRequest=function(e){var t=null;switch(e.bidder){case"audienceNetwork":t=e.params.placementId;break;case"openx":t=e.params.unit;break;case"rubicon":t=e.params.zoneId;break;case"smart_ad_server":t=e.params.pageId;break;case"emx_digital":t=e.params.tagid;break;case"ad_you_like":t=e.params.placement;break;case"appnexus":t=e.params.placementId;break;case"pulsepoint":t=e.params.ct;break;case"adform":t=e.params.mid;break;case"aol":t=e.params.placement;break;case"sovrn":t=e.params.tagid;break;case"districtmDMX":t=e.params.dmxid;break;case"appnexus_inv_code":t=e.params.invCode;break;case"criteo":t=e.params.zoneId;break;case"ix":t=e.params.siteId;break;case"lockerdome":t=e.params.adUnitId;break;case"pubmatic":t=e.params.adSlot;break;case"sharethrough":t=e.params.pkey;break;case"sonobi":t=e.params.ad_unit;break;case"gumgum":t=e.params.inScreen;break;case"triplelift":t=e.params.inventoryCode;break;case"improvedigital":t=e.params.placementId;break;case"33across":t=e.params.siteId;break;case"conversant":t=e.params.site_id;break;case"ias":t=e.params.adUnitPath;break;case"kargo":t=e.params.placementId;break;case"medianet":t=e.params.cid;break;case"yieldmo":t=e.params.placementId;break;case"onemobile":t=e.params.dcn;break;case"districtm":t=e.params.placementId;break;case"adkernel":t=e.params.zoneId;break;case"aja":t=e.params.asi;break;case"yjax":t=e.params.placementId;break;case"rdn":t=e.params.adSpotId;break;case"dgads":t=e.params.location_id;break;case"beyondx":t=e.params.dfpaduid;break;case"aardvark":t=e.params.ai;break;case"gamoshi":t=e.params.supplyPartnerId;break;case"rtbhouse":t=e.params.publisherId;break;case"playgroundxyz":t=e.params.placementId}return t.toString()||""},t.prototype.addCustomConfigByProvider=function(e){var t=this;e.forEach(function(e){if(t.pbjsInstance)switch(e.p){case"pubmatic":case"aardvark":t.pbjsInstance.setConfig({userSync:{filterSettings:{iframe:{bidders:"*",filter:"include"}}}});break;case"ias":t.pbjsInstance.bidderSettings.ias={alwaysUseBid:!0,sendStandardTargeting:!1,suppressEmptyKeys:!0,adserverTargeting:[{key:"adt",val:function(e){return e.adt}},{key:"alc",val:function(e){return e.alc}},{key:"dlm",val:function(e){return e.dlm}},{key:"drg",val:function(e){return e.drg}},{key:"hat",val:function(e){return e.hat}},{key:"off",val:function(e){return e.off}},{key:"vio",val:function(e){return e.vio}},{key:"fr",val:function(e){return e.fr}},{key:"id",val:function(e){return e.slots[e.adUnitCode].id}},{key:"vw",val:function(e){return e.slots[e.adUnitCode].vw}},{key:"grm",val:function(e){return e.slots[e.adUnitCode].grm}},{key:"pub",val:function(e){return e.slots[e.adUnitCode].pub}}]}}})},t.prototype.hasDfpBidder=function(e){return!!e.c.d},t.prototype.getWinner=function(e){if(e.container&&e.container.id&&this.pbjsInstance){var t=e.container.id;return this.pbjsInstance&&this.pbjsInstance.getHighestCpmBids().find(function(e){return e.adUnitCode===t})||null}return null},t.isBrowsiPbjs=!1,t}(a.Provider);t.PrebidJs=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(33),o=i(1),s=i(2),a=i(3),d=i(11),l=i(7),c=function(){function e(){this._foundAds=[],this.logger=new n.Logger("ProvidersDetector"),this._foundAds=[],this.profile=s.Profiler.get()}return e.get=function(){return this.instance||(this.instance=new e),this.instance},Object.defineProperty(e.prototype,"foundAds",{get:function(){return this._foundAds},enumerable:!0,configurable:!0}),e.prototype.addIfNew=function(e,t,i,n,r,s,c,p){if(!(!p&&this.isDetectedAlready(e)||l.Embedder.isEmbeddedByBrowsi(e))){var u=o.Utils.getElementPosition(e).y,h=this.resolveElementSize(e,c),f=this.getAdPositionType(e),g=-1!=f.indexOf("sticky")||-1!=f.indexOf("interstitial")?-1:o.Utils.getElementFoldNumber(e),m=0;if(p){var v=this._foundAds.find(function(t){return t.element===e});v&&(m=++v.refreshCount)}var y={providerName:t,positionType:f,element:e,topPos:u,foldNum:g,width:h.w,height:h.h,placementId:i,adUnit:n,isLazyLoaded:r,refreshCount:m};return this.foundAds.push(y),this.logger.info("Found provider on page: "+t+"("+h.w+"x"+h.h+")",e),a.EventsService.get().sendPublisherAdFound(y),d.ViewabilityService.get().subscribe(this.buildViewabilityServiceObject(y,c)),f}},e.prototype.buildViewabilityServiceObject=function(e,t){return{conf:{minViewInitiator:t&&t.w*t.h>=242500?30:50,duration:1e3},getCoords:function(){return o.Utils.getElementCoordinates(e.element)},getHeight:function(){return o.Utils.getElementSize(e.element).h},metrics:{duration:-1,startTime:null,viewed:!1},runCondition:function(){return!0},refreshInfo:{shouldRefresh:!1,rate:0,doRefresh:function(){}},sendViewedImpression:function(t){return a.EventsService.get().sendViewedPublisherAd(e,t)},root:function(){return e}}},e.prototype.getAdPositionType=function(e){var t=[],i=o.Utils.getElementSize(e),n=o.Utils.getElementPosition(e);if(o.Utils.isPositionFixed(e)&&i.w>.85*this.profile.deviceDetails.screenWidth&&i.h>.85*this.profile.deviceDetails.screenHeight)return t.push("interstitial"),t;if(o.Utils.isPositionFixed(e)&&t.push("sticky"),this.profile.domData&&this.profile.domData.mainContent.inputElements&&this.profile.domData.mainContent.start>-1){for(var r=this.profile.domData.mainContent,s=r.inputElements[0].getBoundingClientRect().width,a=o.Utils.getElementPosition(r.inputElements[0]).x,d=0,l=n.x,c=l+i.w,p=n.y,u=0;u<r.inputElements.length;u++)a=Math.min(a,o.Utils.getElementPosition(r.inputElements[u]).x),d=Math.max(d,a+s);this.logger.debug("MC start: "+r.start+",MC end: "+r.endPosition+",\n\t\t\tarticle offset left: "+a+", article offset right "+d+",ad offset right "+c+",\n\t\t\tad offset left "+l+", ad offset top "+p+", MC elements:",r.inputElements),l>=a&&c<=d?t.push("in-line"):(l<a&&c<=a&&t.push("left rail"),l>=d&&t.push("right rail")),-1==t.indexOf("sticky")&&(p<r.start&&t.push("top"),p>r.endPosition&&t.push("bottom")),-1!=t.indexOf("in-line")&&-1==t.indexOf("sticky")&&-1==t.indexOf("bottom")&&-1==t.indexOf("top")&&t.push("within main content")}else t.push("out of main content");return t},e.prototype.scan=function(e){return e&&r.default.start(),this.foundAds},e.prototype.addFoundProvider=function(e,t,i,n,r,o,s,a,d){return!!this.addIfNew(e,t,n,r,o,s,a,d)},e.prototype.isDetectedAlready=function(e){return!!this.foundAds.some(function(t){return t.element===e})||(!!o.Utils.isDescendantElement(this.foundAds.map(function(e){return e.element}),e)||this.foundAds.some(function(t){return o.Utils.isDescendantElement([e],t.element)}))},e.prototype.resolveElementSize=function(e,t){if(t)return t;var i=e.getBoundingClientRect();return{w:i.width,h:i.height}},e}();t.default=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3),r=i(0),o=i(18),s=i(2),a=i(1),d=i(9),l=i(32),c=i(5),p=i(15);i(34);var u=function(){function e(){this.logger=new r.Logger("App.ts"),this.profile=s.Profiler.get(),this.logger.info("profile: ",this.profile),s.Profiler.detectAdBlocker(function(){return n.EventsService.get().sendAdBlockerEvent()})}return e.prototype.run=function(){if(this.logger.info("started"),this.setUserEngagedListener(),a.Utils.getLoaderParams().e.le&&l.EngagementService.get().subscribe(),this.profile.identity.isBenchmarkPageview)this.SendBenchmarkEvents();else{this.profile.domData=s.Profiler.collectDOMData();var e=this.isProfileValid(this.profile.foldsConfiguration,this.profile.domData);if(a.Utils.shouldLookForFixed()&&e.validForFixed||e.validForDynamic){e.validForFixed||this.logger.warn("Invalid profile for FIXED spots",e.errorMessages),e.validForDynamic||this.logger.warn("Invalid profile for DYNAMIC spots",e.errorMessages);var t=(new o.default).findSpots(e.validForFixed,e.validForDynamic);c.default.instance.setSpots(t);var i=this.profile.analysisMode;t.length&&(i?this.logger.custom("AnalysisMode ON",a.Utils.getLogStyle(18,"red","#000")):d.YieldClient.get().processSpots(t))}else this.profile.state="error",this.logger.warn("Invalid profile",e.errorMessages),n.EventsService.get().sendPageviewEvent(0,0,e.errorMessages)}p.default.get().scan(!0),a.Utils.buildBrowsiOutput(this.profile)},e.prototype.isProfileValid=function(e,t){var i=[];a.Utils.getLoaderParams().e.fs&&(i=s.Profiler.validateProfileForBehavior(e,t.fixedCompatibleSizes,t.fixedSpotsElements).map(function(e){return"FIXED_"+e}));var n=s.Profiler.validateProfileForBehavior(e,t.dynamicCompatibleSizes,t.mainContent.elements).map(function(e){return"DYNAMIC_"+e});return{validForFixed:0===i.length,validForDynamic:0===n.length,errorMessages:i.concat(n)}},e.prototype.SendBenchmarkEvents=function(){this.logger.custom("Benchmark Mode",a.Utils.getLogStyle(30,"black","red")),n.EventsService.get().sendPageviewEvent(0,0),this.profile.state="done",n.EventsService.get().sendSpotEngineDoneEvent()},e.prototype.setUserEngagedListener=function(){var e=this;if(a.Utils.getScrollPosition().top>0)n.EventsService.get().sendUserEngagementEvent();else{var t=function(){e.logger.info("detected engagementScroll, send event"),window.top.removeEventListener("scroll",t),e.profile.engagedUsers.engaged=!0,n.EventsService.get().sendUserEngagementEvent()};window.top.addEventListener("scroll",t)}},e.prototype.desktopRunner=function(){var e=a.Utils.getExternalFlowHandler("engineInitiator");if(e)try{this.logger.info("executing engineInitiator"),e(a.Utils.getLoaderParams(),this.run.bind(this))}catch(e){this.logger.error("failed to execute engineInitiator",e)}else this.run()},e}();function h(){if(("interactive"===document.readyState||"complete"===document.readyState)&&!window._middyo.loaded){window._middyo.loaded=!0;var e=a.Utils.getLoaderParams().e.t,t=new u;e?(t.logger.info("waiting "+e+"mc"),setTimeout(function(){t.desktopRunner()},e)):t.desktopRunner()}}n.EventsService.get().sendEngineLoadedEvent(),window.top.document.onreadystatechange=function(){return h()},window.top.document.addEventListener("readystatechange",function(){return h()}),h()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(1),o=i(2),s=function(){function e(){var e=this;this.observer=null,this.noneFixedHeight=0,this.fixedHeight=0,this.isFixedHeader=!1;var t=o.Profiler.get().fixedHeader;if(this.logger=new n.Logger("FixedHeader"),t&&"function"==typeof window.MutationObserver){var i=t.s,r=document.querySelector(i);r&&(this.updateProperties(r),this.noneFixedHeight=t.h,this.observer=new MutationObserver(function(t){e.updateProperties(r)}),this.observer.observe(r,{attributes:!0}),this.logger.info("found header, watching ",r,t))}}return e.prototype.updateProperties=function(e){var t=this.isHeaderFixed(e);this.isFixedHeader!==t&&this.logger.debug("header fixed: "+t),this.isFixedHeader=t,this.fixedHeight=this.isFixedHeader?r.Utils.getElementSize(e).h:0},e.get=function(){return e._instance||(this._instance=new e),e._instance},e.prototype.getFixedHeaderSize=function(){return this.fixedHeight},e.prototype.getNoneFixedHeaderSize=function(){return this.isFixedHeader?this.noneFixedHeight:0},e.prototype.isHeaderFixed=function(e){return e&&r.Utils.isPositionFixed(e)},e}();t.FixedHeaderService=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),r=i(19),o=i(0),s=i(3),a=i(30),d=i(2),l=i(5),c=i(4),p=i(6),u=i(31),h=function(){function e(){this.logger=new o.Logger("SpotEngine"),this.profile=d.Profiler.get(),this.availableSpots=[],this.dynamicSpots=[],this.fixedSpots=[],this.lastScannedElement=null,this.firstScannedElement=null,this.isMenuPositionFixed=!1,this.spotsStrategy=new a.DefautlSpotsStrategy,this.currentSpotType=c.SpotType.DYNAMIC,this.wrappedElements=[],this.profile.debugMode&&(this.profile.spotEngineTest={})}return e.prototype.findSpots=function(e,t){var i=this;return n.Utils.shouldLookForFixed()&&e&&(this.logger.info("Scanning for fixed spots..."),this.fixedSpots=this.scanFixedSpots(),this.logger.custom("Fixed spots found: "+this.fixedSpots.length,n.Utils.getLogStyle(18,"black","green"),this.fixedSpots),this.logger.custom("Fixed max items: "+this.profile.fixedSpotsConfig.mi,n.Utils.getLogStyle(16,"black","green"))),t&&(this.logger.info("Scanning for dynamic spots..."),this.dynamicSpots=this.scanDynamicSpots(),this.logger.custom("Dynamic spots found: "+this.dynamicSpots.length,n.Utils.getLogStyle(18,"black","green"),this.dynamicSpots),this.logger.custom("Dynamic max items: "+this.profile.spotsConfig.ms,n.Utils.getLogStyle(16,"black","green"))),this.availableSpots=n.Utils.sortSpotsByPosition.apply(n.Utils,this.fixedSpots.concat(this.dynamicSpots)),this.availableSpots.forEach(function(e,t){e.adIndex=t,p.default.isLazyConfiguredForSpotType(e.type,i.profile)&&(e.isLazyLoading=p.default.get().isLazy(e)),s.EventsService.get().sendSpotFoundEvent(e),i.logger.info("Found "+e.type+" spot",e.ref)}),s.EventsService.get().sendPageviewEvent(this.dynamicSpots.length,this.fixedSpots.length),s.EventsService.get().sendSpotEngineDoneEvent(),this.profile.debugMode&&(this.buildSpotEngineTest(),this.profile.state="done"),this.availableSpots},e.prototype.scanFixedSpots=function(){var e=this,t=this.profile.potentialSpots||this.profile.fixedSpotsConfig.mi,i=[];if(!this.profile.domData)return i;for(var o=function(o){if(s.isBelowStopInFold(o))return s.logger.debug("invalid spot [below stop in fold]:",o),"continue";if("invalid"===s.validateSpot(o,!0).status)return"continue";var a=n.Utils.clone(s.profile.domData.fixedCompatibleSizes).filter(function(t){return!e.isCompSizeBiggerThanParentSize(t,o)}),d=s.getCompatibleAdsSizes(o,0,c.SpotType.FIXED,a);if(d.length>0){var l=new r.Spot(o,i.length,d,0,c.SpotType.FIXED);s.logger.info("New fixed spot found: ",l.ref),i.push(l)}else s.logger.debug("invalid fixed spot [no compatible size found]:",o);return i.length>=t?"break":void 0},s=this,a=0,d=this.profile.domData.fixedSpotsElements;a<d.length;a++){if("break"===o(d[a]))break}return i},e.prototype.scanDynamicSpots=function(){var e=this,t=[];if(!this.profile.domData)return t;for(var i=function(i){if(o.wrappedElements.includes(i))return"continue";if(o.spotsStrategy.stopScanning(t))return o.lastScannedElement=i.previousElementSibling,"break";if(o.isBelowStopInFold(i))return o.lastScannedElement=i.previousElementSibling,o.logger.debug("SpotEngine Stopped. StopIF = "+o.profile.foldsConfiguration.stop+", reached element at fold "+n.Utils.getElementFoldNumber(i)+": ",i),"break";if("invalid"===o.validateSpot(i,!1).status)return"continue";var s,a=n.Utils.clone(o.profile.domData.dynamicCompatibleSizes).filter(function(t){return!e.isCompSizeBiggerThanParentSize(t,i)}),d=[],l=o.getNextParagraphsTotalHeight(i,o.profile.wrappingAdditionalElements,a,d),p=o.getCompatibleAdsSizes(i,l,c.SpotType.DYNAMIC,a);if("invalid"===o.validateStayAway(i,t,p,!0).status)return"continue";if(p.length>0){var u=new r.Spot(i,t.length,p,l,c.SpotType.DYNAMIC);o.logger.info("New dynamic spot found: ",u.ref),(s=o.wrappedElements).push.apply(s,d),t.push(u)}else o.logger.debug("invalid dynamic spot [no compatible size found]:",i)},o=this,s=0,a=this.profile.domData.mainContent.elements;s<a.length;s++){if("break"===i(a[s]))break}return this.logger.info("Spots found before filtering: ",t),this.spotsStrategy.selectSpots(t)},e.prototype.isSkippedElement=function(e){return this.profile.domData&&this.profile.domData.skippedElements.some(function(t){return n.Utils.isDescendantElement([t],e)})?{status:"invalid",message:"skipped element"}:{status:"valid"}},e.prototype.isBrowsiStayAway=function(e,t,i){var r=this;return this.alreadyFoundSpots(t)&&t.concat(this.fixedSpots.filter(function(e){return e.positionTypes.includes("in-line")})).some(function(t){var o=n.Utils.calculateDistanceBetween(e,t.ref),s=n.Utils.getHighestElement(e,t.ref),a=e===s?i:t.compatibleSizes,d=n.Utils.getMaxWrapSize(a),l=0;return!n.Utils.isContainedElement(e,t.ref)&&n.Utils.getEmbedTypesFromSizes(a).includes("wrapped")&&(l=n.Utils.getMaxWrappingOffsetDistance(s,d)),o+s.getBoundingClientRect().height+l<=r.profile.spotsConfig.d})?{status:"invalid",message:"stay away from browsi"}:{status:"valid"}},e.prototype.alreadyFoundSpots=function(e){return!(!(e.length>0||this.fixedSpots.length>0)||!this.profile.foldsConfiguration)},e.prototype.isAboveStartInFold=function(e){var t=n.Utils.getElementFoldNumber(e);return this.profile.foldsConfiguration&&t<this.profile.foldsConfiguration.start?{status:"invalid",message:"above startIF("+t+")"}:(this.firstScannedElement||(this.firstScannedElement=e),{status:"valid"})},e.prototype.isBelowStopInFold=function(e){var t=n.Utils.getElementFoldNumber(e);if(this.profile.foldsConfiguration)if(this.profile.foldsConfiguration.stop===Math.floor(this.profile.foldsConfiguration.stop)){if(Math.floor(t)>this.profile.foldsConfiguration.stop)return!0}else if(t>this.profile.foldsConfiguration.stop)return!0;return!1},e.prototype.getNextParagraphsTotalHeight=function(e,t,i,r){for(var o=0,s=n.Utils.getMaxWrapSize(i),a=0;e&&o<s.h&&(!n.Utils.isElement(e)||"valid"===this.isSkippedElement(e).status&&"valid"===l.default.instance.isStayAwayElement(e).status);){if(n.Utils.isElement(e)){if(["auto","hidden","overlay","scroll"].includes(getComputedStyle(e).overflow||""))return this.logger.debug("Stopped height calc. overflow: "+getComputedStyle(e).overflow+". current height: "+o,e),o;!n.Utils.isVisible(e)&&o>0&&e.nextSibling&&(e=e.nextSibling)}switch(e.nodeName){case"BR":break;case"P":if(this.hasNonWrappingChildren(e))return o;n.Utils.isEmptyParagraph(e)?a+=e.getBoundingClientRect().height:(o+=e.getBoundingClientRect().height+a,a=0);break;case"#text":o+=n.Utils.calculateTextNodeHeight(e)+a,a=0;break;default:if(t.includes(e.nodeName)&&!this.hasNonWrappingChildren(e)){o+=e.getBoundingClientRect().height+a,a=0;break}return o}r.push(e),e=e.nextSibling}return o},e.prototype.hasNonWrappingChildren=function(e){var t=e.querySelector("img, iframe");return!!t&&(this.logger.info("stopping height calc because "+e.nodeName+" element has special child: ",t),!0)},e.prototype.getCompatibleAdsSizes=function(e,t,i,n){var r=[];if(!this.profile.domData)return r;for(var o=e.getBoundingClientRect().height,s=0,a=n;s<a.length;s++){var d=a[s],l=i===c.SpotType.DYNAMIC?d.optionalEmbeddings.indexOf("wrapped"):-1;l>-1?this.isSizeValidForWrapping(t,o,d)||d.optionalEmbeddings.splice(l,1):i===c.SpotType.FIXED&&(d.selectedEmbedding="break"),d.optionalEmbeddings.length&&r.push(d)}return r},e.prototype.isSizeValidForWrapping=function(e,t,i){return t>=i.minSizeForWrapping&&e>0||e>=i.minSizeForWrapping},e.prototype.buildSpotEngineTest=function(){if(this.lastScannedElement&&this.firstScannedElement){var e=n.Utils.getElementFoldNumber(this.lastScannedElement),t=n.Utils.getElementFoldNumber(this.firstScannedElement);this.profile.spotEngineTest={firstElementFold:t,lastElementFold:e,spots:this.availableSpots.map(function(e){return e.serialize()})}}else this.profile.spotEngineTest={spots:this.availableSpots.map(function(e){return e.serialize()})}},e.prototype.validateSpot=function(e,t){var i=this.isAboveStartInFold(e).message||this.isSkippedElement(e).message||(t?null:this.isEmptyParagraph(e).message||this.isElementWithFloatSibling(e).message)||this.isBetweenTitleAndContent(e).message,n=i?{status:"invalid",message:i}:{status:"valid"};return"invalid"===n.status&&this.logger.debug("invalid spot ["+n.message+"]:",e),n},e.prototype.isEmptyParagraph=function(e){return n.Utils.isEmptyParagraph(e)?{status:"invalid",message:"empty"}:{status:"valid"}},e.prototype.isCompSizeBiggerThanParentSize=function(e,t){var i=!1;if(t.parentElement){var r=n.Utils.getElementSize(t.parentElement);r&&e.w>r.w&&(i=!0)}return i},e.prototype.validateStayAway=function(e,t,i,n){var r=l.default.instance.isStayAwayForAllEmbedTypes(e,i,n),o=r.message?null:this.isBrowsiStayAway(e,t,i).message,s=r.message||o,a=s?{status:"invalid",message:s}:{status:"valid"};return"invalid"===a.status&&(r.message?this.logger.debug("invalid spot ["+a.message,{element:e,stayAwayElement:r.element}):this.logger.debug("invalid spot ["+a.message+"]:",e)),a},e.prototype.isElementWithFloatSibling=function(e){return this.profile.domData&&this.profile.domData.foundFloatElements.includes(e)?{status:"invalid",message:"element with float sibling"}:{status:"valid"}},e.prototype.isBetweenTitleAndContent=function(e){return this.profile.disableSpotAfterTitle&&u.default.get().isBetweenTitleAndContent(e)?{status:"invalid",message:"element is between title and content"}:{status:"valid"}},e}();t.default=h},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),r=i(0),o=i(2),s=i(9),a=i(11),d=i(3),l=function(){function e(t,i,o,s,a){this.conf={minViewInitiator:50,duration:1e3},this.wholeConf={minViewInitiator:100,duration:1e3},this.ref=t,this.adIndex=-1,this.type=a,this.typeIndex=i,this.demandIndex=i,this.attemptIndex=1,this.isSaas=!1,this.compatibleSizes=o,this.availableHeight=s,this.offsetTop=n.Utils.getElementCoordinates(t).top,this.viewability={viewed:!1,duration:-1},this.browsiAd={h:-1,w:-1},this.isImpression=!1,this.logger=new r.Logger("Spot"),this.refresh={refreshed:!1,requested:!1,active:!1,cap:0,count:0,impressionsEventCount:0,rate:0,do:!1,kv:!1};var d=this.getTableIfExists();if(d){var l=document.createElement("tr"),c=document.createElement("td");c.setAttribute("colspan",100..toString()),c.setAttribute("style","width: 100%; display: none;"),l.appendChild(c),this.tableConfiguration={table:d,columns:100,adWrapper:l,mainTd:c}}this.adRequestBlockedSent=!1,this.isLazyLoading=!1,this.spotRenderEnded=0,this.positionTypes=e.getPositionType(t)}return e.prototype.getExpectedEmbedding=function(){var e=this.compatibleSizes.map(function(e){return e.selectedEmbedding});if(1!==n.Utils.toSet(e).size)return"na";switch(e[0]){case"break":return"b";case"right":return"r";case"left":return"l";default:return"na"}},e.prototype.expand=function(e){var t=this;return new Promise(function(i,r){if(t.browsiAd.wrapper){var o=n.Utils.isFluidSize(e),s=document.querySelector("#"+t.browsiAd.wrapper.id),a=n.Utils.getAdMarkingExpectedHeight();if(s){var d=t.tableConfiguration&&s&&s.parentElement?s.parentElement:null;s.setAttribute("height",""+(o?"auto":e.h+a)),s.setAttribute("width",""+(o?"100%":e.w)),s.setAttribute("style",t.getEmbeddingStyle(e)),d&&d.setAttribute("style","width: 100%;"),t.browsiAd.iframe&&t.browsiAd.iframe.setAttribute("style","text-align:center;display: block;margin: auto;width: "+e.w+"px !important; height: "+e.h+"px !important;");var l=n.Utils.getElementCoordinates(s);o?setTimeout(function(){var e=s.getBoundingClientRect();t.browsiAd.w=e.width,t.browsiAd.h=e.height,t.browsiAd=n.Utils.merge(t.browsiAd,{offsetTop:l.top,offsetLeft:l.left}),i({w:t.browsiAd.w,h:t.browsiAd.h})},800):(t.browsiAd=n.Utils.merge(t.browsiAd,{offsetTop:l.top,offsetLeft:l.left}),i({w:t.browsiAd.w,h:t.browsiAd.h}))}}else r({w:-1,h:-1})})},e.prototype.setSelectedSize=function(e){this.selectedSize=this.findSize(e),this.browsiAd=Object.assign({},this.browsiAd,e)},e.prototype.isSizeInSpot=function(e){return!!this.findSize(e)},e.prototype.findSize=function(e){return this.compatibleSizes.find(function(t){return t.w===+e.w&&t.h===+e.h})},e.prototype.getDomId=function(){return this.domId||"e"},e.prototype.setDomId=function(e){this.domId=e},e.prototype.getEmbeddingStyle=function(e){var t="";return e.selectedEmbedding?t=this.buildStyle(e,o.Profiler.get().spotsConfig.s):this.logger.error("no embedding for spot "+this.adIndex,this.browsiAd.wrapper),t},e.prototype.buildStyle=function(e,t){var i="";if("break"===e.selectedEmbedding){var r=n.Utils.isFluidSize(e);i="text-align:center;display:block;clear: both !important;"+(d="margin: auto;margin-top:"+t.b.m.t+"px !important;margin-bottom:"+t.b.m.b+"px !important")+";width:"+(r?"100%":"auto")+" !important; height: auto !important;"}else{var o=n.Utils.getAdMarkingExpectedHeight(),s="left"===e.selectedEmbedding?t.l:t.r,a=getComputedStyle(this.ref),d="margin-top:"+(-1===s.m.t?parseInt(a.marginTop||"0"):s.m.t)+"px !important;\n                             margin-right:"+s.m.r+"px !important;\n                             margin-bottom:"+s.m.b+"px !important;\n                             margin-left:"+s.m.l+"px !important",l="padding-top:"+(-1===s.p.t?parseInt(a.paddingTop||"0"):s.p.t)+"px !important;\n                             padding-right:"+s.p.r+"px !important;\n                             padding-bottom:"+s.p.b+"px !important;\n                             padding-left:"+s.p.l+"px !important";i="text-align:center;float:"+e.selectedEmbedding+";position:relative;"+n.Utils.removeSpaces(d)+";"+n.Utils.removeSpaces(l)+";width:"+e.w+"px !important; height:"+(e.h+o)+"px !important;"}return i},e.prototype.insertAdMarking=function(){var e=o.Profiler.get().adMarking;if(e&&this.browsiAd.wrapper&&this.selectedSize&&!this.browsiAd.admarking){var t=n.Utils.buildAdMarking(this,e);this.browsiAd.wrapper.insertBefore(t,this.browsiAd.wrapper.firstChild),this.browsiAd.admarking=t}},e.prototype.getTableIfExists=function(){return this.ref?n.Utils.findParentElementByType("table",this.ref):null},e.prototype.updateRefreshDetails=function(e){this.refresh.requested||this.isAllowedProvider(e)&&(this.refresh=Object.assign(this.refresh,{active:e.ri&&e.ri.e,refreshed:!!this.refresh.refreshed&&this.refresh.refreshed,requested:!!this.refresh.requested&&this.refresh.requested,count:this.refresh.count?this.refresh.count:0,impressionsEventCount:this.refresh.impressionsEventCount?this.refresh.impressionsEventCount:0,cap:e.ri&&e.ri.c?e.ri.c:0,rate:e.ri&&e.ri.r?e.ri.r:0,do:!(!e.ri||!e.ri.do)&&e.ri.do,kv:!(!e.ri||!e.ri.kv)&&e.ri.kv}))},e.prototype.removeAdFromDom=function(){if(this.browsiAd.wrapper){var e=document.querySelector("#"+this.browsiAd.wrapper.id);if(!(e&&document.body.contains(e)&&e.parentNode))return!1;if(this.browsiAd.admarking&&this.browsiAd.admarking.parentElement===e&&this.removeAdMarkingFromDom(),!this.tableConfiguration)return e.parentNode.removeChild(e),!0;var t=e.parentElement;if(t&&t.parentNode)return t.parentNode.removeChild(t),!0}return!1},e.prototype.removeAdMarkingFromDom=function(){return!(!this.browsiAd.admarking||!this.browsiAd.admarking.parentNode)&&(this.browsiAd.admarking.parentNode.removeChild(this.browsiAd.admarking),delete this.browsiAd.admarking,!0)},e.prototype.refreshSpot=function(){this.canRefresh()&&(this.logger.info("Refreshing spot #"+this.adIndex),a.ViewabilityService.get().unsubscribe(this),this.refresh=Object.assign(this.refresh,{requested:!0,refreshed:!1,oldWrapper:this.browsiAd.wrapper}),this.refresh.count++,this.waterfall=[],s.YieldClient.get().processSingleSpot(this))},e.prototype.canRefresh=function(){return!this.isRefreshing()&&this.spotShouldRefresh()},e.prototype.isRefreshing=function(){return this.refresh.active&&this.refresh.requested&&!this.refresh.refreshed},e.prototype.spotShouldRefresh=function(){return this.refresh.active&&this.refresh.count<this.refresh.cap},e.prototype.endRefreshProcess=function(){this.logger.debug("end refresh process for spot #"+this.adIndex),this.refresh.requested=!1,this.refresh.refreshed=!1},e.prototype.handleRefreshedDone=function(){this.isRefreshing()&&(this.refresh.oldWrapper&&(this.removeAdMarkingFromDom(),n.Utils.removeElement(this.refresh.oldWrapper),n.Utils.reportBrowsiAdRemoved(this.refresh.oldWrapper)),this.refresh.requested=!1,this.refresh.refreshed=!0,this.viewability={viewed:!1,duration:-1,startTime:void 0},this.logger.info("spot #"+this.adIndex+" refreshed with count "+this.refresh.count))},e.prototype.updateBrowsiAdWrapper=function(){this.refresh.oldWrapper&&(this.browsiAd.wrapper=this.refresh.oldWrapper,this.domId=this.refresh.oldWrapper.id,this.browsiAd.container=document.getElementById(this.refresh.oldWrapper.id.replace("adWrapper","adContainer"))||void 0)},e.prototype.initializeTypeIndex=function(e){this.typeIndex=e,this.demandIndex=e},e.prototype.isAllowedProvider=function(e){return"header_bidding"!==this.providerName||!!e.c.d},Object.defineProperty(e.prototype,"refreshInfo",{get:function(){var e=this;return{shouldRefresh:this.spotShouldRefresh(),rate:this.refresh.rate,doRefresh:function(){return e.refreshSpot()}}},enumerable:!0,configurable:!0}),e.prototype.sendViewedImpression=function(e){d.EventsService.get().sendViewedImpression(this,e)},e.prototype.sendViewedImpression100=function(e){d.EventsService.get().sendViewedImpression100(this)},e.getPositionType=function(e){var t=o.Profiler.get(),i=[],r=n.Utils.getElementSize(e),s=n.Utils.getElementPosition(e);if(t.domData&&t.domData.mainContent.inputElements&&t.domData.mainContent.start>-1){for(var a=t.domData.mainContent,d=a.inputElements[0].getBoundingClientRect().width,l=n.Utils.getElementPosition(a.inputElements[0]).x,c=0,p=s.x,u=Math.round(p+r.w),h=s.y,f=0;f<a.inputElements.length;f++)l=Math.min(l,n.Utils.getElementPosition(a.inputElements[f]).x),c=Math.max(c,l+d);p>=l&&u<=c?i.push("in-line"):(p<l&&u<=l&&i.push("left rail"),p>=c&&i.push("right rail")),h<a.start&&i.push("top"),h>a.endPosition&&i.push("bottom"),-1!=i.indexOf("in-line")&&-1==i.indexOf("bottom")&&-1==i.indexOf("top")&&i.push("within main content")}else i.push("out of main content");return 0===i.length&&i.push("unknown"),i},e.prototype.subscribeToViewabilityService=function(){a.ViewabilityService.get().subscribe(this.buildViewabilityServiceObject(this.wholeConf)),a.ViewabilityService.get().subscribe(this.buildViewabilityServiceObject(this.conf))},e.prototype.buildViewabilityServiceObject=function(e){var t=this,i=e.minViewInitiator===this.wholeConf.minViewInitiator,r=i?this.sendViewedImpression100.bind(this):this.sendViewedImpression.bind(this);return{conf:e,getCoords:function(){return n.Utils.getSpotCoords(t)},getHeight:function(){return t.browsiAd.h},metrics:{duration:-1,startTime:null,viewed:!1},runCondition:function(){return t.isImpression},refreshInfo:i?{shouldRefresh:!1,rate:0,doRefresh:function(){}}:this.refreshInfo,sendViewedImpression:r,root:function(){return t}}},e.prototype.updateInSpotEngineTest=function(){var e=o.Profiler.get();e.debugMode&&e.spotEngineTest&&e.spotEngineTest.spots&&(e.spotEngineTest.spots[this.adIndex]=this.serialize())},e.prototype.serialize=function(){return{ref:this.ref,adIndex:this.adIndex,attemptIndex:this.attemptIndex,viewability:this.viewability,compatibleSizes:this.compatibleSizes,availableHeight:this.availableHeight,selectedSize:this.selectedSize,tableConfiguration:this.tableConfiguration,offsetTop:this.offsetTop,browsiAd:{iframe:this.browsiAd.iframe,wrapper:this.browsiAd.wrapper,container:this.browsiAd.container,admarking:this.browsiAd.admarking,w:this.browsiAd.w,h:this.browsiAd.h},adUnit:this.adUnit,isSaas:this.isSaas,providerName:this.providerName,isImpression:this.isImpression,slot:this.slot,domId:this.domId,logger:this.logger,refresh:this.refresh,adRequestBlockedSent:this.adRequestBlockedSent,isLazyLoading:this.isLazyLoading,spotRenderEnded:this.spotRenderEnded,waterfall:this.waterfall,positionTypes:this.positionTypes,type:this.type,typeIndex:this.typeIndex}},e}();t.Spot=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.SRA="sra",e.SINGLE="single"}(t.DemandRequestType||(t.DemandRequestType={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(12),o=i(2),s=i(6),a=i(3),d=i(4),l=i(5),c=i(1),p=i(7),u=i(22),h=i(25),f=i(9),g=function(){function e(){this.logger=new n.Logger("YieldClient"),this.profile=o.Profiler.get()}return e.get=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.processResponse=function(e,t,i){var n=this;switch(t.rt){case"empty":return void this.logger.info("getDemand returned empty, waterfall ended for spot "+e.adIndex);case"provider":var o=t;this.logger.info("getDemand returned ["+o.c.p+"] for spot "+e.adIndex+", attempt "+e.attemptIndex,t),e.adUnit="generic_js"===o.c.p?"NA":o.c.au;break;case"header_bidding":var a=t;this.logger.info("getDemand returned ["+a.c.c+"] for spot "+e.adIndex+", attempt "+e.attemptIndex,t),e.adUnit="NA";break;case"sra":if(!this.sraManager){var d=t;this.sraManager=new r.SRAResponseManager(d,i)}}this.isLazySpot(e)&&!e.isRefreshing()?s.default.get().subscribe(e,function(){return n.matchResponse(t,e)}):this.matchResponse(t,e)},e.prototype.matchResponse=function(t,i){var n=e.isSRAResponse(t)&&this.sraManager?this.sraManager.peek(i):t;if(n){var r=this.checkSpotViolations(i,n);if("invalid"===r.status)this.handleAdRequestBlock(i,r);else{var o=e.isSRAResponse(t)&&this.sraManager?this.sraManager.pop(i,n):n;if(o){if("empty"===o.rt)return void this.logger.info("getDemand returned empty, waterfall ended for spot "+i.adIndex);i.isSaas=o.s,this.fetch(o,i)}}}},e.prototype.fetch=function(e,t){var i=this,n=u.EmbeddingFactory.getEmbedder(e,t),r=h.ProviderFactory.getProvider(e,t);r&&n?(this.runPreFetch(t,e,r),t.updateRefreshDetails(e),r.fetch(e,n).then(function(n){switch(i.logger.logWaterfallDetails(t,e,n.status),n.status){case"failure":case"timeout":case"not_supported":case"generic_snippet_error":t.removeAdFromDom(),t.updateBrowsiAdWrapper(),f.YieldClient.get().nextWaterfallStep(t);break;case"success":i.logger.info("SUCCESS"),o.Profiler.get().enableMoat&&p.Embedder.injectMoat(t),i.runPostFetch(t,e)}})):f.YieldClient.get().nextWaterfallStep(t)},e.prototype.isLazySpot=function(e){return s.default.isLazyConfiguredForSpotType(e.type,this.profile)&&e.isLazyLoading},e.isSRAResponse=function(e){return"sra"===e.rt},e.prototype.handleAdRequestBlock=function(e,t){e.adRequestBlockedSent||(t.expectedSize?(this.logger.debug("spot "+e.adIndex+" blocked it's size doesn't match generic expected size: "+t.expectedSize),a.EventsService.get().sendAdBlockedEvent(e,"generic_js_size_mismatch",t.message?t.message:"")):(this.logger.debug("spot "+e.adIndex+" blocked because of stayAway from "+t.element),a.EventsService.get().sendAdBlockedEvent(e,"stay_away",t.message?t.message:"")))},e.prototype.checkSpotViolations=function(e,t){var i={status:"valid"};return e.type!==d.SpotType.DYNAMIC||e.isRefreshing()||(i=l.default.instance.isStayAwayViolated(e)),"provider"===t.rt&&"generic_js"===t.c.p&&(i=this.checkGenericExpectedSizeToSpot(e,t)),i},e.prototype.checkGenericExpectedSizeToSpot=function(e,t){var i={w:Number(t.c.a.expectedWidth),h:Number(t.c.a.expectedHeight)};return e.isSizeInSpot(i)?{status:"valid"}:{status:"invalid",message:"generic_js_size_mismatch",expectedSize:i}},e.prototype.runPreFetch=function(e,t,i){var n=c.Utils.getExternalFlowHandler("preFetch");if(n)try{t.kv=t.kv||[],this.logger.info("executing preFetch"),n(e,i,t)}catch(e){this.logger.error("failed to execute preFetch",e)}},e.prototype.runPostFetch=function(e,t){var i=c.Utils.getExternalFlowHandler("postFetch");if(i)try{this.logger.info("executing postFetch"),i(e,t)}catch(e){this.logger.error("failed to execute postFetch",e)}},e}();t.DemandManager=g},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(23),r=i(24),o=function(){function e(){}return e.getEmbedder=function(e,t){if("header_bidding"===e.rt)return e.c.if?new r.default(t):new n.default(t);var i=e;switch(i.c.p){case"dfp":case"generic_js":return"true"===i.c.a.inIFrame?new r.default(t):new n.default(t);case"appnexus":case"appnexus_inv_code":case"adform":case"sovrn":case"districtmdmx":case"pulsepoint":case"aol":case"openx":case"rubicon":case"smart_ad_server":case"ad_you_like":case"audiencenetwork":case"criteo":case"index_exchange":case"lockerdome":case"pubmatic":case"brealtime":case"sharethrough":case"sonobi":case"gumgum":case"triple_lift":case"conversant":case"across":case"kargo":case"medianet":case"yieldmo":case"onemobile":case"districtm":case"adkernel":case"aja":case"yjax":case"rdn":case"dgads":case"aardvark":case"gamoshi":return new r.default(t);default:return null}},e}();t.EmbeddingFactory=o},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.appendAndGetWrapper=function(e){var t=this;return new Promise(function(i,n){if(e.ref&&e.ref.parentNode){var r=document.createElement("div"),o=document.createElement("div");r.setAttribute("spotType",e.type),r.setAttribute("typeIndex",""+e.typeIndex),o.id=t.containerId,r.id=t.wrapperId,r.appendChild(o),r.style.display="none",t.appendAd(e,r),e.browsiAd.win=window,e.browsiAd.wrapper=r,e.browsiAd.container=o,e.browsiAd.iframe=null,i(e.browsiAd)}else n(e.browsiAd)})},t}(i(7).Embedder);t.default=o},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.appendAndGetWrapper=function(e){var t=this;return new Promise(function(i,n){if(e.ref&&e.ref.parentNode){var r=!1,o=document.createElement("div"),s=document.createElement("iframe");o.setAttribute("spotType",e.type),o.setAttribute("typeIndex",""+e.typeIndex),o.appendChild(s),o.id=t.wrapperId,s.id=t.containerId,s.scrolling="no",s.frameBorder="0",s.marginHeight="0",s.marginWidth="0",s.height="0",s.width="0",s.style.display="none",s.onload=function(){if(!r){r=!0,s.contentDocument.open(),s.contentDocument.close();var n=s.contentDocument.createElement("div");n.setAttribute("id",t.containerId),s.contentDocument.body.appendChild(n),e.browsiAd.win=s.contentWindow,e.browsiAd.wrapper=o,e.browsiAd.container=n,e.browsiAd.iframe=s,i(e.browsiAd)}},s.onerror=function(){n(e.browsiAd)},t.appendAd(e,o)}else n(e.browsiAd)})},t}(i(7).Embedder);t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(13),r=i(27),o=i(28),s=i(29),a=function(){function e(){}return e.getProvider=function(e,t){switch(e.rt){case"provider":var i=e;switch(i.c.p){case"dfp":return new n.DFP(t);case"generic_js":return new s.GenericJS(t,i);case"appnexus_inv_code":return new r.SingleBidder(t,"appnexus",i.c);case"appnexus":case"adform":case"sovrn":case"districtmdmx":case"pulsepoint":case"aol":case"openx":case"rubicon":case"smart_ad_server":case"ad_you_like":case"audiencenetwork":case"criteo":case"index_exchange":case"lockerdome":case"pubmatic":case"brealtime":case"sharethrough":case"sonobi":case"gumgum":case"triple_lift":case"across":case"conversant":case"kargo":case"medianet":case"yieldmo":case"onemobile":case"districtm":case"adkernel":case"aja":case"yjax":case"rdn":case"dgads":case"aardvark":case"gamoshi":return new r.SingleBidder(t,i.c.p,i.c);default:return null}case"header_bidding":var a=e;return t.providerName="header_bidding",new o.HeaderBiddingDA(t,a.c.c,a.c.d)}return null},e}();t.ProviderFactory=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=function(){function e(e){this.resizeRAF=null,this.resizeListeners=[],this.isIE=null!=navigator.userAgent.match(/Trident/),this.resizeElement=e,this.obj=document.createElement("object"),this.logger=new n.Logger("ResizeListener"),this.logger.debug("set resize listener for",e)}return e.prototype.resizeListener=function(e){var t=this;this.resizeRAF&&window.cancelAnimationFrame(this.resizeRAF),this.resizeRAF=window.requestAnimationFrame(function(){t.resizeListeners.forEach(function(i){i.call(t.obj,e)})})},e.prototype.objectLoad=function(){this.obj.contentDocument.defaultView.addEventListener("resize",this.resizeListener.bind(this)),this.resizeListener.bind(this)()},e.prototype.addResizeListener=function(e){this.resizeListeners.length||("static"==getComputedStyle(this.resizeElement).position&&(this.resizeElement.style.position="relative"),this.obj.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -999;"),this.obj.onload=this.objectLoad.bind(this),this.obj.type="text/html",this.isIE&&this.resizeElement.appendChild(this.obj),this.obj.data="about:blank",this.isIE||this.resizeElement.appendChild(this.obj)),this.resizeListeners.push(e)},e.prototype.removeResizeListener=function(e){e?this.resizeListeners.splice(this.resizeListeners.indexOf(e),1):this.resizeListeners=[],this.resizeListeners.length||(this.obj.contentDocument.defaultView.removeEventListener("resize",this.resizeListener),this.resizeElement.removeChild(this.obj))},e}();t.default=r},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(14),s=i(0),a=i(3),d=function(e){function t(t,i,n){var r=e.call(this,t,i,[n],null)||this;return r.hasFluidSizeSupport=!1,r.logger=new s.Logger("SingleBidder"),r}return r(t,e),t.prototype.handlePbjsCommands=function(e,t,i,n){var r=this;this.adUnit=this.buildAdUnit(t.container&&t.container.id||"",e.od),this.pbjsInstance&&(this.runPreAuction(this.spot,this.adUnit),this.pbjsInstance.que=this.pbjsInstance.que||[],this.pbjsInstance.que.push(function(){r.pbjsInstance&&(r.pbjsInstance.setConfig(r.getConfig()),r.addCustomConfigByProvider([e.c]),a.EventsService.get().sendAdRequest(r.spot,r.providerName),r.adUnit&&r.pbjsInstance.addAdUnits(r.adUnit),r.pbjsInstance.requestBids({adUnitCodes:[r.adUnit?r.adUnit.code:""],auctionId:r.profile.identity.articleId,bidsBackHandler:function(o){return r.bidsBackHandler(o,t,e,i,n)}}))}))},t.prototype.bidsBackHandler=function(e,t,i,n,r){if(t.wrapper&&t.iframe&&t.container){var o=this.getHighestBidById(e,t.container.id);if(this.pbjsInstance&&o&&o.adId&&o.width&&o.height){var s={w:o.width,h:o.height};return this.spot.setSelectedSize(s),this.spot.providerName=this.providerName,a.EventsService.get().sendAdMatchedEvent(this.spot,this.providerName,!0),this.renderAd(t,o,n)}}this.spot.isImpression=!1,a.EventsService.get().sendAdMatchedEvent(this.spot,this.providerName,!1),n({status:"failure"})},t}(o.PrebidJs);t.SingleBidder=d},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(14),s=i(0),a=i(3),d=i(1),l=function(e){function t(t,i,n){void 0===n&&(n=null);var r=e.call(this,t,"header_bidding",i,n)||this;return r.logger=new s.Logger("HB"),r.dfpTimeout=null,r}return r(t,e),t.prototype.handlePbjsCommands=function(e,t,i,n){var r=this;this.isRefreshDfpOnly(e)?e.c.c=[]:this.adUnit=this.buildAdUnit(t.container&&t.container.id||"",e.od),this.pbjsInstance&&(this.runPreAuction(this.spot,this.adUnit),this.pbjsInstance.que=this.pbjsInstance.que||[],this.pbjsInstance.que.push(function(){a.EventsService.get().sendAdRequest(r.spot,r.providerName),r.pbjsInstance&&(r.pbjsInstance.setConfig(r.getConfig(e,!0)),r.addCustomConfigByProvider(e.c.c),r.hasDfpBidder(e)&&r.pbjsInstance.onEvent("bidWon",function(e){return e&&r.winnerHandler(e,r.spot)}),r.adUnit&&(r.pbjsInstance.addAdUnits(r.adUnit),r.sendBidRequests(r.adUnit)),r.pbjsInstance.requestBids({adUnitCodes:[r.adUnit?r.adUnit.code:""],auctionId:r.profile.identity.articleId,bidsBackHandler:function(o){return r.bidsBackHandler(o,t,e,i,n)}}))}))},t.prototype.bidsBackHandler=function(e,t,i,n,r){var o=t.container?t.container.id:"",s=this.isRefreshDfpOnly(i)?null:this.getWinner(t);this.sendBidMatchedEvents(o),this.logger.hbLog(e&&e[o],o,this.getNoBids(o),s?s.bidder:"NA"),this.hasDfpBidder(i)?this.requestDfpBid(t,i,e,s,n):(a.EventsService.get().sendAdMatchedEvent(this.spot,"header_bidding",!!s),s?(this.spot.setSelectedSize({w:s.width,h:s.height}),this.renderAd(t,s,n)):n({status:"failure"}))},t.prototype.requestDfpBid=function(e,t,i,n,r){var o=this;this.addGPTScriptTag(e).then(function(){var s=e.container?e.container.id:"",a=o.buildSizesArray();o.pushGPTCommands(a,e,t,s),o.dfpTimeout=setTimeout(function(){return o.dfpTimeoutHandler(t,n,i,s,e,r)},t.c.d.t),e.win.googletag.cmd.push(function(){e.win.googletag.pubads().addEventListener("slotRenderEnded",function(i){return o.slotRenderEndedHandler(t,s,e,i,r)})})})},t.prototype.slotRenderEndedHandler=function(e,t,i,n,r){if(this.isBrowsiSlot(n,t)){if(this.dfpTimeout&&clearTimeout(this.dfpTimeout),this.spot.spotRenderEnded++,this.isForcedRefresh())return this.handleForcedRefreshSlotRenderEnded(e,n,r);var o=d.Utils.getDfpEventSize(n);return this.sendDfpBidMatched(e,!n.isEmpty,o),this.logger.info("dfp(da) "+(n.isEmpty?"empty":JSON.stringify(o))+" for "+this.getAdSelector()),n.isEmpty?(this.destroyDFPSlots(i),a.EventsService.get().sendAdMatchedEvent(this.spot,"header_bidding",!1),r({status:"failure"})):(this.spot.selectedSize||this.spot.setSelectedSize(o),a.EventsService.get().sendAdMatchedEvent(this.spot,"header_bidding",!0),this.expandAd(this.spot,r,{adUnit:"NA",provider:"header_bidding_da"}))}},t.prototype.winnerHandler=function(e,t){this.adUnit&&this.adUnit.code===e.adUnitCode&&(this.dfpTimeout&&clearTimeout(this.dfpTimeout),this.spot.setSelectedSize({w:e.width,h:e.height}),a.EventsService.get().sendHBWinner(t,e))},t.prototype.sendDfpBidMatched=function(e,t,i){a.EventsService.get().sendBidMatched([{adUnit:e.c.d.au,bidderName:"dfp",bidRate:-1,currency:"NA",isMatched:t,size:i}],this.spot,d.Utils.getSpotCoords(this.spot))},t.prototype.dfpTimeoutHandler=function(e,t,i,n,r,o){a.EventsService.get().sendBidMatched([{adUnit:e.c.d.au,bidderName:"dfp",bidRate:-1,currency:"NA",isMatched:!1,size:{w:-1,h:-1},reason:"dfp_timeout"}],this.spot,d.Utils.getSpotCoords(this.spot)),a.EventsService.get().sendAdMatchedEvent(this.spot,this.spot.providerName||"",!!t,"dfp_timeout"),t?(this.destroyDFPSlots(r),this.spot.setSelectedSize({w:t.width,h:t.height}),this.renderAd(r,t,o)):o({status:"timeout"})},t.prototype.pushGPTCommands=function(e,t,i,n){var r=this,o=i.c.d.a,s="false"===o.upc||!o.upc,d=t.win.googletag||{};d.cmd=d.cmd||[],d.cmd.push(function(){if(r.pbjsInstance){var l=d.defineSlot("/"+o.pubID+"/"+i.c.d.au,e,n);l.addService(d.pubads()),r.addKeyValues(i,l),d.pubads().enableSingleRequest(),d.enableServices(),r.pbjsInstance.que.push(function(){r.pbjsInstance.setTargetingForGPTAsync([n]),t.iframe?d.display(n):(googletag.display(t.wrapper?t.wrapper.id:n),googletag.pubads().refresh([l],{changeCorrelator:s}));var e={bidderName:"dfp",adUnit:i.c.d.au};a.EventsService.get().sendBidRequest([e],r.spot)}),r.spot.slot=l}})},t.prototype.destroyDFPSlots=function(e){this.spot.slot&&e.win&&(e.win.googletag.destroySlots([this.spot.slot]),this.spot.slot=void 0)},t.prototype.isRefreshDfpOnly=function(e){return this.spot.isRefreshing()&&e.ri.do},t.prototype.isForcedRefresh=function(){return this.spot.spotRenderEnded>this.spot.attemptIndex&&!this.spot.isRefreshing()},t.prototype.handleForcedRefreshSlotRenderEnded=function(e,t,i){var n={adUnit:e.c.d.au,bidderName:"dfp",bidRate:-1,currency:"NA",isMatched:!t.isEmpty,size:d.Utils.getDfpEventSize(t),reason:"forced_refresh"};if(a.EventsService.get().sendBidMatched([n],this.spot,d.Utils.getSpotCoords(this.spot)),a.EventsService.get().sendAdMatchedEvent(this.spot,this.spot.providerName||"header_bidding",!t.isEmpty,"forced_refresh"),!t.isEmpty){var r=this.spot.selectedSize?this.spot.selectedSize.selectedEmbedding:void 0;a.EventsService.get().sendAdImpression(this.spot,this.spot.providerName||"header_bidding",r),this.spot.updateInSpotEngineTest()}i({status:"success",args:{adUnit:"NA",provider:"header_bidding_da"}})},t}(o.PrebidJs);t.HeaderBiddingDA=l},function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(10),s=i(0),a=i(3),d=i(1),l=function(e){function t(t,i){var n=e.call(this,t,"generic_js")||this;n.logger=new s.Logger("GenericJS");var r=i.c.a;n.isJs="true"===r.isJS,n.snippetUrl=r.url,n.isCallback="true"===r.withCallback,n.callbackInvoked=!1;var o={w:Number(r.expectedWidth),h:Number(r.expectedHeight)};return n.expectedSize=t.findSize(o),n}return r(t,e),t.prototype.fetch=function(e,t){var i=this;return new Promise(function(n,r){return a.EventsService.get().sendAdRequest(i.spot,i.providerName),t.appendAndGetWrapper(i.spot).then(function(t){return d.Utils.xhrPromise(i.snippetUrl).then(function(r){return i.runSnippet(t,r,e,n)}).then(function(r){return i.handleResult(r,t,e,n)}).catch(function(e){a.EventsService.get().sendAdMatchedEvent(i.spot,i.providerName,!1),n({status:"generic_snippet_error",args:{provider:"generic_js",adUnit:"NA"}})})}).catch(function(e){i.logger.error(e),a.EventsService.get().sendAdMatchedEvent(i.spot,i.providerName,!1),n({status:"generic_snippet_error",args:{provider:"generic_js",adUnit:"NA"}})})})},t.prototype.runSnippet=function(e,t,i,n){var r=this;return this.isCallback&&this.assignBrowsiCallbackToWindow(e,n),new Promise(function(n,o){if(e.container){e.container.className=e.container.id;var s=t.replace(/<DIV_ID>/g,""+e.container.id).replace(/<SPOT_INDEX>/g,r.spot.adIndex.toString()).replace(/<BROWSI_VIEWABILITY_PREDICTION>/g,i.od&&i.od[50]?r.getBrowsiViewability(i.od[50]):"NA");s&&r.expectedSize&&r.spot.expand(r.expectedSize).then(function(){if(r.isJs)e.win.eval(s),n({status:"success"});else if(e.container){e.container.innerHTML=s;var t=d.Utils.findAllChildrenScripts(e.container);r.copyAndAppendScriptTag(e.container,t,n,o)}}).catch(function(e){r.logger.error(e),o({status:"generic_snippet_error"})})}else o({status:"error"})})},t.prototype.copyAndAppendScriptTag=function(e,t,i,n){Array.from(t).forEach(function(t){var i=document.createElement("script");Array.from(t.attributes).forEach(function(e){i.setAttribute(e.name,e.value)}),t.parentElement&&t.parentElement.removeChild(t),i.text=t.text,e.appendChild(i)}),i({status:"success"})},t.prototype.assignBrowsiCallbackToWindow=function(e,t){var i=this;window.top["browsiCallback_"+this.spot.adIndex]=function(n){i.callbackInvoked=!0,i.logger.info("spot: ",i.spot),n?(a.EventsService.get().sendAdMatchedEvent(i.spot,i.providerName,!1),t({status:"failure"})):i.handleAd(e,t)}},t.prototype.handleResult=function(e,t,i,n){var r=this;if(t.container&&"success"===e.status)if(this.isAdInViewport().then(function(e){e&&r.sendAdInViewEvent(r.spot)}),this.isCallback)setTimeout(function(){return r.onCallbackTriggered(t,n)},i.c.t);else{var o=!1;t.container.style.display="block";var s=setInterval(function(){var e=d.Utils.getElementSize(t.container);e.w>0&&e.h>0&&(clearInterval(s),o=!0,r.onCallbackTriggered(t,n))},200);setTimeout(function(){o||(clearInterval(s),a.EventsService.get().sendAdMatchedEvent(r.spot,r.providerName,!1),n({status:"failure"}))},i.c.t)}},t.prototype.onCallbackTriggered=function(e,t){this.callbackInvoked||this.handleAd(e,t)},t.prototype.handleAd=function(e,t){var i=d.Utils.getElementSize(e.container);i.h<1?(this.logger.info("spot "+this.spot.adIndex+" has height < 1"),a.EventsService.get().sendAdMatchedEvent(this.spot,this.providerName,!1),d.Utils.removeElement(this.spot.browsiAd.wrapper),t({status:"failure"})):(a.EventsService.get().sendAdMatchedEvent(this.spot,this.providerName,!0),this.expectedSize&&(this.spot.selectedSize=Object.assign({},this.expectedSize,i),this.spot.browsiAd.h=this.spot.selectedSize.h,this.spot.browsiAd.w=this.spot.selectedSize.w,this.expandAd(this.spot,t)),t({status:"success",fetchTime:-1,args:{adUnit:"NA",provider:"generic_js"}}))},t}(o.Provider);t.GenericJS=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(2),o=i(1),s=function(){function e(){this.logger=new n.Logger("SpotsStrategy"),this.profile=r.Profiler.get(),this.maxItems=this.profile.potentialSpots||this.profile.spotsConfig.ms,this.logger.custom("spots strategy: default",o.Utils.getLogStyle(18,"black","green")),this.logger.custom("Allow narrow ads to break: "+this.profile.allowNarrowBreak+", Allow narrow ads wrap: "+(this.profile.domData&&this.profile.domData.allowNarrowWrap)+" ",o.Utils.getLogStyle(18,"white","blue"))}return e.prototype.stopScanning=function(e){return this.maxItems===this.filterSpotsBy(e,"narrow","wrapped",!1).length},e.prototype.selectSpots=function(e){var t=this.maxItems,i=[],n=[],r=this.filterSpotsBy(e,"narrow","wrapped",!0,t);this.logger.debug("selected narrow spots with wrap: ",r),(t-=r.length)>0&&(i=this.filterSpotsBy(e,"narrow","break",!0,t,r),this.logger.debug("selected narrow spots with break: ",i),t-=i.length),t>0&&(n=this.filterSpotsBy(e,"wide","break",!0,t,r.concat(i)),this.logger.debug("selected wide spots with break: ",n));var s=o.Utils.sortSpotsByOffsetTop.apply(o.Utils,r.concat(i,n)).slice(0,this.maxItems);return(s=this.assignWrappingDirection(s)).forEach(function(e,t){e.initializeTypeIndex(t)}),s},e.prototype.selectEmbeddings=function(e){return e.forEach(function(e){e.compatibleSizes.forEach(function(e){e.selectedEmbedding=e.optionalEmbeddings.includes("wrapped")?"wrapped":"break"})}),e},e.prototype.filterSpotsBy=function(e,t,i,n,r,o){var s=e.filter(function(e){return(!o||!o.includes(e))&&e.compatibleSizes.filter(function(e){return e.adSizeType===t&&e.optionalEmbeddings.includes(i)}).length>0});return r&&Number.isInteger(r)&&r<s.length&&(s=s.slice(0,r)),n&&(s=this.selectEmbeddings(s)),s},e.prototype.getWrapType=function(){return"random"===this.profile.spotsConfig.et?Math.random()>.5?"left":"right":this.profile.spotsConfig.et},e.prototype.assignWrappingDirection=function(e){var t=this;return e.forEach(function(e){e.compatibleSizes.forEach(function(e){"wrapped"===e.selectedEmbedding&&(e.selectedEmbedding=t.getWrapType())})}),e},e}();t.DefautlSpotsStrategy=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(1),o=function(){function e(){this.titleSelectors=["h1","h2","h3","h4","h5","h6","header"],this.titleToContentDistance=60,this.logger=new n.Logger("ContentTitle"),this.titlesOnPage=this.collectTitles(),this.titlesLocations=this.getTitlesLocations(this.titlesOnPage)}return e.get=function(){return e.instance||(this.instance=new e),e.instance},e.prototype.collectTitles=function(e){return Array.from((e||document).querySelectorAll(this.titleSelectors.join(","))).filter(function(e){return r.Utils.isVisible(e)})},e.prototype.getTitlesLocations=function(e){var t=this;return e.map(function(e){return t.getBottomOffset(e)}).filter(function(e){return e>0}).sort(function(e,t){return e-t})},e.prototype.isTitle=function(e){return-1!=this.titlesOnPage.indexOf(e)},e.prototype.isBetweenTitleAndContent=function(e){var t=r.Utils.getElementPosition(e).y;if(t<1)return!1;if(this.isTitle(e)){var i=this.getBottomOffset(e),n=this.titlesLocations.indexOf(i);if(n&&this.titlesLocations[n-1])return t-this.titlesLocations[n-1]<this.titleToContentDistance}for(var o=this.titlesLocations.length;o>=0;o--)if(t>this.titlesLocations[o])return t-this.titlesLocations[o]<this.titleToContentDistance;return!1},e.prototype.getBottomOffset=function(e){return r.Utils.getElementPosition(e).y+r.Utils.getElementSize(e).h},e}();t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(1),o=i(3),s=i(2),a=i(8),d=function(){function e(){this.isSubscribed=!1,this.timeoutObjId=null,this.logger=new n.Logger("EngagementService"),this.logger.info("initializing"),this.engagementCounter=0,this.lastScrollingDistance=0,this.lastEngagementReport=0,this.engagementsCounter=0,this.eventsBatchCounter=0,this.engagementsBatch=[],this.profile=s.Profiler.get(),this.isHidden=!1,this.hiddenTime=0,this.hiddenTimeDelta=0,this.outOfFocusTime=0,a.Focus.instance.subscribe(this.onFocusChanged.bind(this))}return e.get=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.subscribe=function(){var e=this;if(this.isSubscribed)this.logger.info("Already subscribed!");else{this.isSubscribed=!0;var t=r.Utils.getLoaderParams().e.tber||2;this.setEventInterval(),this.timeoutObjId=setTimeout(function(){e.eventsSender(t)},1e3*t)}},e.prototype.setEventInterval=function(){var e=this;this.eventSenderInterval=setInterval(function(){e.isSubscribed||clearInterval(e.eventSenderInterval),e.isHidden||(e.eventsBatchCounter++,e.engagementsCounter++,e.engagementsBatch.push(e.buildEngagementData()))},1e3)},e.prototype.unsubscribe=function(){this.isSubscribed=!1,a.Focus.instance.unsubscribe(),this.timeoutObjId&&clearTimeout(this.timeoutObjId)},e.prototype.buildEngagementData=function(){var e=Date.now(),t=r.Utils.getScrollingDistance()-this.lastScrollingDistance,i=Math.abs(this.lastScrollingDistance?t:0),n=this.getTimeDelta(e),o={et:"general_engagement",c:this.engagementsCounter,dep:r.Utils.getScrollDepthPercentages(),po:r.Utils.getScrollingDistance(),pl:r.Utils.getPageHeight(),td:n,pd:i,sl:r.Utils.getWindowHeight(),now:r.Utils.getNowInSeconds(),lt:this.getLoadTime(),plt:this.getPageLoadTime(),to:r.Utils.getTimeOffset(),top:this.getTimeOnPage(),mcst:this.profile.domData?this.profile.domData.mainContent.start:-1,mcs:r.Utils.getMainContentSize(this.profile.domData),v:Math.round(i/(n/1e3))||0};return this.lastScrollingDistance=r.Utils.getScrollingDistance(),this.lastEngagementReport=e,o},e.prototype.eventsSender=function(e){var t=this;this.isSubscribed&&(!this.isHidden&&this.engagementsBatch.length>0&&(e=this.calculateNextEventSend(e),o.EventsService.get().sendEngagementReportEvent(this.engagementsBatch),this.engagementsBatch=[]),this.timeoutObjId=setTimeout(function(){t.eventsSender(e)},1e3*e))},e.prototype.calculateNextEventSend=function(e){return this.eventsBatchCounter>=60&&(this.eventsBatchCounter=0,e+=2),(r.Utils.getTimeOffset()/1e3>=600||!r.Utils.getCookie("__browsiSessionID"))&&this.unsubscribe(),e},e.prototype.getTimeOnPage=function(){var e=r.Utils.getTimeOffset()/1e3,t=this.outOfFocusTime/1e3;return Number((e-t).toFixed(2))},e.prototype.getTimeDelta=function(e){var t=this.lastEngagementReport?e-this.lastEngagementReport:0;return this.hiddenTimeDelta>0&&(t=this.hiddenTimeDelta,this.hiddenTimeDelta=0),t},e.prototype.getLoadTime=function(){try{if(window.performance&&window.performance.timing.navigationStart>0&&window.performance.timing.domInteractive>0)return Math.floor(window.performance.timing.domInteractive-window.performance.timing.navigationStart)}catch(e){}return-1},e.prototype.getPageLoadTime=function(){try{if("complete"===document.readyState&&window.performance&&window.performance.timing.loadEventEnd>0&&window.performance.timing.domContentLoadedEventStart>0)return Math.floor(Math.abs(window.performance.timing.loadEventEnd-window.performance.timing.domContentLoadedEventStart))}catch(e){}return-1},e.prototype.onFocusChanged=function(e){if(this.isHidden=e,e)this.hiddenTime=Date.now(),clearInterval(this.eventSenderInterval);else{this.hiddenTime>0&&(this.outOfFocusTime=this.outOfFocusTime+(Date.now()-this.hiddenTime));var t=Date.now(),i=t-this.hiddenTime;this.hiddenTimeDelta=this.lastEngagementReport?t-this.lastEngagementReport-i:0,this.logger.info("Out Of focus time: "+this.outOfFocusTime/1e3+" seconds, time on page: "+this.getTimeOnPage()),this.setEventInterval()}},e}();t.EngagementService=d},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Logger_1=__webpack_require__(0),Utils_1=__webpack_require__(1),ProvidersDetector_1=__webpack_require__(15),Profiler_1=__webpack_require__(2),DFP_1=__webpack_require__(13),DfpDetector=function(){function DfpDetector(){this.logger=new Logger_1.Logger("Dfp Detector"),this.googletag=window.googletag||{},this.googletag.cmd=this.googletag.cmd||[],this.isActive=!1}return DfpDetector.start=function(){this.instance?this.instance.logger.info("already started"):(this.instance=new DfpDetector,this.instance.logger.info("starting"),this.instance.run())},DfpDetector.restart=function(){this.instance?this.instance.checkFetchedSlots():this.start()},DfpDetector.setInactive=function(){this.instance.isActive=!1},DfpDetector.prototype.run=function(){this.isActive=!0,this.listenToLazyAds(),this.checkFetchedSlots()},DfpDetector.prototype.checkFetchedSlots=function(){var e=this;this.logger.debug("checkFetchedSlots"),this.checkCurrentSlots(),setTimeout(function(){return e.checkCurrentSlots()},1e3)},DfpDetector.prototype.checkCurrentSlots=function(){var e=this;this.logger.debug("checking current slots"),this.googletag.cmd.push(function(){e.googletag.pubads().getSlots().forEach(function(t){var i=document.getElementById(t.getSlotElementId());if(i){var n=e.resolveInnerMostSingleChild(i),r=Utils_1.Utils.getElementSize(n);e.validationPassed(i,t)&&t.getResponseInformation()&&(e.isRendered(n,r)?ProvidersDetector_1.default.get().addFoundProvider(i,e.getProviderType(t),!0,e.getPlacementId(t),t.getAdUnitPath(),!1,t,r):e.handleThirdPartySlowAdRendering(i,t,!1))}})})},DfpDetector.prototype.getProviderType=function(e){var t=e.getTargetingKeys();return-1!=t.indexOf("hb_pb")&&-1!=t.indexOf("hb_size")?"header_bidding":"dfp"},DfpDetector.prototype.isRendered=function(e,t){return Utils_1.Utils.isVisible(e)&&DFP_1.DFP.isValidSize(t)},DfpDetector.prototype.listenToLazyAds=function(){var e=this;this.googletag.cmd.push(function(){e.googletag.pubads().addEventListener("slotRenderEnded",function(t){if(t=t,e.isActive&&!t.isEmpty){var i=document.getElementById(t.slot.getSlotElementId());if(i){var n=e.resolveInnerMostSingleChild(i);e.validationPassed(i,t.slot)?e.isRendered(n,t.size)?ProvidersDetector_1.default.get().addFoundProvider(i,e.getProviderType(t.slot),!1,e.getPlacementId(t.slot),t.slot.getAdUnitPath(),!0,t.slot,Utils_1.Utils.getDfpEventSize(t)):e.handleThirdPartySlowAdRendering(i,t.slot,!0):e.isForcedRefreshed(i,t.slot)&&ProvidersDetector_1.default.get().addFoundProvider(i,e.getProviderType(t.slot),!1,e.getPlacementId(t.slot),t.slot.getAdUnitPath(),!0,t.slot,Utils_1.Utils.getDfpEventSize(t),!0)}}})})},DfpDetector.prototype.handleThirdPartySlowAdRendering=function(e,t,i){var n=this;this.waitForDeflating(e).then(function(r){n.logger.debug("deflated to ",r,e),ProvidersDetector_1.default.get().addFoundProvider(e,n.getProviderType(t),!1,n.getPlacementId(t),t.getAdUnitPath(),i,t,r)}).catch(function(t){return n.logger.debug("did not deflate",t,e)})},DfpDetector.prototype.validationPassed=function(e,t){return!this.isBrowsiAd(t)&&!ProvidersDetector_1.default.get().isDetectedAlready(e)},DfpDetector.prototype.isBrowsiAd=function(e){var t=e.getSlotElementId();return/^browsi_ad.*_ai_\d_ati_\d.*$/.test(t)},DfpDetector.prototype.resolveAdSize=function(e){for(var t,i=e;1===(t=this.getNonScriptChildren(i)).length;)i=t[0];return Utils_1.Utils.getElementSize(i)},DfpDetector.prototype.resolveInnerMostSingleChild=function(e){for(var t,i=e;1===(t=this.getNonScriptChildren(i)).length;)i=t[0];return i},DfpDetector.prototype.getNonScriptChildren=function(e){return Array.from(e.children).filter(function(e){return"SCRIPT"!==e.tagName})},DfpDetector.prototype.waitForDeflating=function(e){var t=this;return new Promise(function(i,n){var r=10;t.logger.debug("waiting for deflation",e);var o=setInterval(function(){var s=t.resolveAdSize(e);DFP_1.DFP.isValidSize(s)&&(clearInterval(o),i(s)),r--||(clearInterval(o),n(s))},500)})},DfpDetector.prototype.isForcedRefreshed=function(e,t){return!this.isBrowsiAd(t)&&ProvidersDetector_1.default.get().isDetectedAlready(e)},DfpDetector.prototype.getPlacementId=function(slot){var macro=Profiler_1.Profiler.get().placementIdMacro;if(macro)try{var macroResult=eval(macro.replace(/<DIV_ID>/g,""+slot.getSlotElementId()).replace(/<AD_UNIT>/g,""+slot.getAdUnitPath()).replace(/<KEY_(\w+)>/g,function(e,t){return t&&slot.getTargeting(t).join("_")||"NA"}));return this.logger.info("macro result: "+macro+" => "+macroResult),macroResult}catch(e){this.logger.error("failed to evaluate: "+macro)}return slot.getSlotElementId()},DfpDetector}();exports.default=DfpDetector},function(e,t){var i,n,r,o;if(Array.prototype.reduce||Object.defineProperty(Array.prototype,"reduce",{value:function(e){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var t,i=Object(this),n=i.length>>>0,r=0;if(arguments.length>=2)t=arguments[1];else{for(;r<n&&!(r in i);)r++;if(r>=n)throw new TypeError("Reduce of empty array with no initial value");t=i[r++]}for(;r<n;)r in i&&(t=e(t,i[r],r,i)),r++;return t}}),Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=[],r=arguments.length>=2?arguments[1]:void 0,o=0;o<i;o++)if(o in t){var s=t[o];e.call(r,s,o,t)&&n.push(s)}return n}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n=arguments[1],r=0;r<i;){var o=t[r];if(e.call(n,o,r,t))return o;r++}}}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])}return i},writable:!0,configurable:!0}),Array.from||(Array.from=(i=Object.prototype.toString,n=function(e){return"function"==typeof e||"[object Function]"===i.call(e)},r=Math.pow(2,53)-1,o=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),r)},function(e){var t=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var i,r=arguments.length>1?arguments[1]:void 0;if(void 0!==r){if(!n(r))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(i=arguments[2])}for(var s,a=o(t.length),d=n(this)?Object(new this(a)):new Array(a),l=0;l<a;)s=t[l],d[l]=r?void 0===i?r(s,l):r.call(i,s,l):s,l+=1;return d.length=a,d})),Array.prototype.some||(Array.prototype.some=function(e){"use strict";if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof e)throw new TypeError;for(var t=Object(this),i=t.length>>>0,n=arguments.length>=2?arguments[1]:void 0,r=0;r<i;r++)if(r in t&&e.call(n,t[r],r,t))return!0;return!1}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0===n)return!1;var r,o,s=0|t,a=Math.max(s>=0?s:n-Math.abs(s),0);for(;a<n;){if((r=i[a])===(o=e)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;a++}return!1}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n=arguments[1],r=0;r<i;){var o=t[r];if(e.call(n,o,r,t))return r;r++}return-1},configurable:!0,writable:!0}),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},"function"!=typeof window.CustomEvent){window.CustomEvent=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}}}]);