define(['storage'],function(store){var _session=(function(){var _str=store,self={},s={guid:null},_guid=function(k){if(!k){k=_str.get('guid');}
if(!k&&typeof window.generatedGuid!=="undefined"){k=window.generatedGuid;}
s.guid=k?k:s.guid;if(s.guid){_str.set('guid',s.guid);}
return s.guid;},_fld=function(nm){if(nm){return _str.get(nm);}},_fld_raw=function(nm){if(nm){return _str.get_raw(nm);}},_generateGuid=function(){var S4=function(){return(((1+Math.random())*0x10000)|0).toString(16).substring(1);};guid=(S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4());if(typeof window.generatedGuid!=="undefined"){guid=window.generatedGuid;}
return guid;}
self.guid=function(k){return _guid(k);};self.save_cookie=function(k,v){_str.set(k,v,false);};self.save_cookie_shrt=function(k,v,e){_str.cookie(k,v,e);};self.save_cookie_dm=function(k,v,e,p,s,dmStr){_str.cookie_dm(k,v,e,p,s,dmStr);};self.delete_cookie=function(name,path,domain){document.cookie=name+"="+
((path)?";path="+path:"")+
((domain)?";domain="+domain:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT";};self.save_localstorage=function(k,v){_str.set('storage_updated',true,true);_str.set(k,v,true);};self.setGuid=function(){var guid=self.guid()||'';if(guid==''){self.save_localstorage('guid',_generateGuid());}};self.fld=function(nm){return _fld(nm);};self.fld_raw=function(nm){return _fld_raw(nm);};self.get_user=function(key,field){if(!field){field='profile';}
if(key){return $.ajax({url:window.url_countrycode+'/api/sess/index',type:'GET',data:{"input_data":{"key":key,"field":field}},success:function(result,textStatus){return result;}});}};self.create_user=function(key,field){if(key&&field){$.ajax({url:window.url_countrycode+'/api/sess/index',type:'POST',data:{"input_data":field},success:function(result,textStatus){return result;}});}};self.update_user=function(key,field){if(key&&field){$.ajax({url:window.url_countrycode+'/api/sess/index',type:'PUT',data:{"input_data":field},success:function(result,textStatus){return result;}});}};self.delete_user=function(key,field){if(key&&field){$.ajax({url:window.url_countrycode+'/api/sess/index',type:'DELETE',data:{"input_data":field},success:function(result,textStatus){return result;}});}};self.init=function(){self.setGuid();};return self;});return _session();});;