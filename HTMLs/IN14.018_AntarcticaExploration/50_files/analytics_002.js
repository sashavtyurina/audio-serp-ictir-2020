!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=t.BID_INFO="erps_info",r=10;t.BidTracker=function(){function e(t,n,i){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.localStorageHandler=t,this.window=n,this.document=n.document,this.eventSender=i,setInterval(function(){return o.updateBidsData()},1e3*r)}return i(e,[{key:"loadSessionBids",value:function(){return this.localStorageHandler.getStoredObject(o)||{}}},{key:"storeSessionBids",value:function(e){this.localStorageHandler.storeObject(o,e)}},{key:"updateBidsData",value:function(){var e=0,t=this.loadSessionBids(),n=null;if(this.getAvailableBidWinners().filter(function(e){var n=e.hb_adid;return!t[n]}).forEach(function(i){if(i&&i.hb_pb){var o=parseFloat(i.hb_pb);e+=o,t[i.hb_adid]=o,n=i.hb_adid}}),this.storeSessionBids(t),e>0){var i=e/1e3;this.sendPurchaseEvent(this.round(i),n)}}},{key:"round",value:function(e){return+(Math.round(e+"e+5")+"e-5")}},{key:"sendPurchaseEvent",value:function(e,t){this.eventSender.send("Purchase",{value:e,currency:"USD",lwid:t})}},{key:"getEstimatedRevPerSession",value:function(){var e=Object.values(this.loadSessionBids()).reduce(function(e,t){return t&&(e+=parseFloat(t)),e},0);return this.round(e)}},{key:"getAvailableBidWinners",value:function(){var e=[];return this.window.gb_kaleidoscope&&this.window.gb_kaleidoscope.ad_slots&&this.window.gb_kaleidoscope.ad_slots.forEach(function(t){t.prebid_winner&&e.push(t.prebid_winner)}),e}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=t.NUMBER_OF_VIEWED_IMAGES="kw.images_storage",r=t.CURRENT_PAGE_URL="kw.current_page_url",a=t.MAX_VIEWED_IMAGES_PER_PAGE="kw.max_images_per_page",s=t.IMAGES_INFO="imagesInfo";t.ImagesTracker=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.localStorageHandler=t,this.window=n,this.document=n.document}return i(e,[{key:"getNumberImagesViewed",value:function(){var e=this.localStorageHandler.getStoredObject(s),t=e[o],n=e[r],i=this.document.URL,c=e[a],u=0,l=0;t&&(l=t),c&&(u=c);var d=this.getCurrentAmountOfImages();if(n===i){if(!(d>u))return l;l=l-u+d}else l+=d,e[r]=i;return e[o]=l,e[a]=d,this.localStorageHandler.storeObject(s,e),l}},{key:"getCurrentAmountOfImages",value:function(){var e=this.window,t=this.document.getElementsByTagName("img");return Array.prototype.slice.call(t).filter(function(e){return e.getBoundingClientRect().top<0}).filter(function(t){return t.height/e.screen.availHeight*100>10&&t.width/e.screen.availWidth*100>10}).length}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString(),i=e.getDate().toString();return t+(n[1]?n:"0"+n[0])+(i[1]?i:"0"+i[0])},o=t.firstLoadTime=new Date;t.todayStr=i(o),t.last30DaysDateStr=i(new Date((new Date).setDate(o.getDate()-30))),t.firstMonthDateStr=i(new Date(o.getFullYear(),o.getMonth(),1)),t.roundToTwo=function(e){return+(Math.round(e+"e+2")+"e-2")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.LocalStorageHandler=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setLocalStorage(t)}return i(e,[{key:"setLocalStorage",value:function(e){var t,n,i;try{i=(new Date).toString(),(t=e.localStorage).setItem(i,i),n=t.getItem(i)===i,t.removeItem(i),n||(t=!1)}catch(e){}this.storage=t}},{key:"clearLocalStorage",value:function(e){this.storage&&this.storage.removeItem(e)}},{key:"storeObject",value:function(e,t){this.storage&&this.storage.setItem(e,JSON.stringify(t))}},{key:"getStoredObject",value:function(e){var t=this.storage&&this.storage.getItem(e);return t?JSON.parse(t):{}}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionTracker=t.SESSION_COOKIE_NAME=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(1),r=n(0);var a=t.SESSION_COOKIE_NAME="kw.session_ts";t.SessionTracker=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cookieHandler=t,this.localStorageHandler=n}return i(e,[{key:"initSessionData",value:function(e){this.cookieHandler.createCookie(a,e,1/48),this.setPageViewsPerSessionCount(1)}},{key:"setPageViewsPerSessionCount",value:function(e){this.cookieHandler.createCookie("kw.pv_session",e,1)}},{key:"getCurrentPageViewPerSession",value:function(){var e=this.cookieHandler.getCookie("kw.pv_session"),t=0;return e&&(t=parseInt(e)),t}},{key:"getAndUpdateSessionData",value:function(e){var t=e.getTime(),n=1,i=0,a=this.getExisitingSessionStart();a?(n=this.getCurrentPageViewPerSession()+1,i=Math.floor((t-a)/1e3),this.setPageViewsPerSessionCount(n)):(this.initSessionData(t),this.localStorageHandler.clearLocalStorage(o.IMAGES_INFO),this.localStorageHandler.clearLocalStorage(r.BID_INFO));return{pageViews:n,sessionLengthSeconds:i}}},{key:"getExisitingSessionStart",value:function(){var e=this.cookieHandler.getCookie(a),t=null;return e&&(t=parseInt(e)),t}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.CookieHandler=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.document=t,this.domain=n}return i(e,[{key:"getCookie",value:function(e){var t=("; "+this.document.cookie).split("; "+e+"=");if(2===t.length)return t.pop().split(";").shift()}},{key:"createCookie",value:function(e,t,n){var i,o;if(n){var r=new Date;r.setTime(r.getTime()+864e5*n),i="; expires="+r.toGMTString()}else i="";o=e+"="+t+i+"; path=/;",this.domain&&(o=o+" Domain="+this.domain),this.document.cookie=o}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=null,r=function(e,t,n){var r,a,s,c,u,l,d=(r=window.pageYOffset||document.documentElement.scrollTop,a=document.body,s=document.documentElement,c=window.innerHeight,u=Math.max(a.scrollHeight,a.offsetHeight,s.clientHeight,s.scrollHeight,s.offsetHeight),(0,i.roundToTwo)(Math.min(100,r/(u-c)*100))),f=null,h=d!==o,g=(0,i.roundToTwo)((new Date-i.firstLoadTime)/6e4);h&&!(g>30)&&(f={tsop:g,lop:d,noaip:(l=document.getElementsByTagName("iframe"),Array.prototype.slice.call(l).filter(function(e){return e.dataset.googleContainerId}).length),noims:e.getNumberImagesViewed()},t&&(f.erps=t.getEstimatedRevPerSession()),n.sendCustom("KWCEPA",f),o=d)};t.default=function(e,t,n,i){var o=1e3*(e=e||30);setInterval(r.bind(null,t,n,i),o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initAdvancedPixel=t.sendAdvancedPageView=void 0;var i=n(2),o=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},r=null,a=null,s=null,c=null,u=function(){return a.getStoredObject("keyweeHistory")},l=function(e){a.storeObject("keyweeHistory",e)},d=function(e){var t,n,o=r.document.title,a=r.location.href.indexOf("kwp_4=")>0,s=(t=e||i.todayStr,u()[t]||{date:t});return s.categories||(s.categories={}),s.categories.general||(s.categories.general={articles_read:0,keywee_articles_read:0,time_spent:0,category:"general"}),(n=s.categories.general).last_visited_article!==o&&(n.articles_read++,a&&n.keywee_articles_read++,n.last_visited_article=o),function(e,t){var n=u();n[e]=t,l(n)}(e||i.todayStr,s),s},f=function(e,t){var n=u();return function(e,t,n){return Object.keys(e).filter(function(e){return e>=t&&(!n||e<=n)})}(n,e,t).map(function(e){return n[e]})};t.sendAdvancedPageView=function(){var e;d(),e=function(){var e=f(i.last30DaysDateStr),t=f(i.firstMonthDateStr),n=f(i.todayStr,i.todayStr),r=s.getAndUpdateSessionData(new Date),a=function(e){return 1===e.length?o(e[0].categories):e.reduce(function(e,t){return e.concat(o(t.categories))},[])},c=function(e,t){return 1===e.length?e[0][t]:e.reduce(function(e,n){return e+n[t]},0)},u=a(e),l=a(t),d=c(a(n),"keywee_articles_read"),h={noad30:e.length,noadcm:t.length,nokart:d,pvps:r.pageViews,slensec:r.sessionLengthSeconds};return["articles_read","keywee_articles_read","time_spent"].forEach(function(e){var t=function(e){return e.split("_").map(function(e){return e[0]}).join("")}(e);[[t+"30d",u],[t+"cm",l]].forEach(function(t){var n=t[0],o=t[1],r=c(o,e);h[n]=(0,i.roundToTwo)(r)})}),h=function(e){return e.kar30d>0&&0===e.nokart?e.kru=1:e.kru=0,e}(h)}(),c.sendCustom("KWCEPV",e),c.send("PageView")},t.initAdvancedPixel=function(e,t,n,o){var u,d,h;c=o,r=e,a=n,s=t,d=i.last30DaysDateStr,h={},i.firstMonthDateStr<d&&(d=i.firstMonthDateStr),u&&(d=u),f(d).forEach(function(e){h[e.date]=e}),l(h)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.DEFAULT_SNOWPLOW_SRC="//dc8xl0ndzn2cb.cloudfront.net/sp.js";t.SnowplowManager=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appendScriptToDom=function(e,t,n,i,o,r,a){e[o]||(e.GlobalSnowplowNamespace=e.GlobalSnowplowNamespace||[],e.GlobalSnowplowNamespace.push(o),e[o]=function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].q=e[o].q||[],r=t.createElement(n),a=t.getElementsByTagName(n)[0],r.async=1,r.src=i,a.parentNode.insertBefore(r,a))},this.initSnowplow=function(e,t,n,o,r,a){o=o||30,a=a||i,this.appendScriptToDom(e,e.document,"script",a,"snowplowKW"),e.snowplowKW("newTracker","cf","pixel.keywee.co",{appId:t,cookieDomain:n}),e.snowplowKW("setVisitorCookieTimeout",33696e3),r&&e.snowplowKW("enableActivityTracking",o,o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.FacebookEventSender=function(){function e(t,n){var i,o,r,a,s,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=t,o=t.document,r="script",i.fbq||(a=i.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},i._fbq||(i._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],(s=o.createElement(r)).async=!0,s.src="//connect.facebook.net/en_US/fbevents.js",(c=o.getElementsByTagName(r)[0]).parentNode.insertBefore(s,c)),t.fbq("init",n),this.window=t,this.fbPixelId=n}return i(e,[{key:"sendCustom",value:function(e,t){this.window.fbq&&this.window.fbq("trackSingleCustom",this.fbPixelId,e,t)}},{key:"send",value:function(e,t){this.window.fbq&&this.window.fbq("trackSingle",this.fbPixelId,e,t)}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tracker=void 0;var i,o=n(9),r=n(8),a=n(7),s=n(6),c=(i=s)&&i.__esModule?i:{default:i},u=n(5),l=n(4),d=n(3),f=n(1),h=n(0);t.Tracker=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.snowplowManager=new r.SnowplowManager,this.setKeyweeAdId=function(e){var n=new RegExp("kwp_4=([^&#]*)","i").exec(t.location.href),i=n&&unescape(n[1])||"";""!==i&&this.cookieHandler.createCookie("keywee.kwp_4",i,30),t.snowplowKW&&t.snowplowKW("setUserIdFromCookie","keywee.kwp_4")},this.getConfig=function(e){var n=t.document.createElement("script");n.type="text/javascript",n.src="//cdn.keywee.co/config/"+e+".js",this.testConfigPath&&(n.src=this.testConfigPath),t.document.getElementsByTagName("head")[0].appendChild(n)},this.initiateTracking=function(){var e=this.config,n=this.testDomain||e.domain,i=null;this.cookieHandler=new u.CookieHandler(t.document,n),this.localStorageHandler=new d.LocalStorageHandler(t);var r=new f.ImagesTracker(this.localStorageHandler,t),s=new l.SessionTracker(this.cookieHandler,this.localStorageHandler);e.fbPixelId&&(this.facebookEventSender=new o.FacebookEventSender(window,e.fbPixelId),e.bt&&(i=new h.BidTracker(this.localStorageHandler,t,this.facebookEventSender)),(0,c.default)(this.pixelPeriodTimeSec,r,i,this.facebookEventSender),(0,a.initAdvancedPixel)(t,s,this.localStorageHandler,this.facebookEventSender)),e.appId&&this.snowplowManager.initSnowplow(t,e.appId,n,this.pixelPeriodTimeSec,e.ping_activity,e.snowplow_src),this.setKeyweeAdId(n),this.sendPageView()},this.loadConfig=function(e){var t=e.in_eu||!1;this.config=e,t&&!this.trackEU||this.initiateTracking()},this.init=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.pixelPeriodTimeSec=t.pixelPeriodTimeSec,this.testDomain=t.testDomain,this.testConfigPath=t.testConfigPath,void 0===t.trackEU?this.trackEU=!0:this.trackEU=t.trackEU,this.getConfig(e)},this.sendPageView=function(){t.snowplowKW&&t.snowplowKW("trackPageView"),this.config.fbPixelId&&(0,a.sendAdvancedPageView)(this.config.fbPixelId)},this.setCustomUrl=function(e){t.snowplowKW&&t.snowplowKW("setCustomUrl",e)},this.applyFunc=function(){try{var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),t=e.slice(1),n=e[0];"initialize"===n?this.init.apply(this,t):"sendPageView"===n?this.sendPageView.apply(this,t):"loadConfig"===n?this.loadConfig.apply(this,t):"setCustomUrl"===n&&this.setCustomUrl.apply(this,t)}catch(t){n=e[0],console.log("Error in keywee-analytics-tracker occurred trying to run the function "+n+": ",t)}}}},function(e,t,n){"use strict";var i=new(n(10).Tracker)(window);window.kwa&&window.kwa.q&&window.kwa.q.forEach(function(e){i.applyFunc.apply(i,e)});window.kwa=i.applyFunc.bind(i)}]);
//# sourceMappingURL=analytics.min.js.map